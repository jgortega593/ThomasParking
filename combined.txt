LISTA DE ARCHIVOS PROCESADOS:
C:\ThomasParking\ThomasParking\dist\assets\index-DzlgHYNC.css
C:\ThomasParking\ThomasParking\src\App.jsx
C:\ThomasParking\ThomasParking\src\main.jsx
C:\ThomasParking\ThomasParking\src\components\AuthGuard.jsx
C:\ThomasParking\ThomasParking\src\components\CapturaCamara.jsx
C:\ThomasParking\ThomasParking\src\components\DetalleConsulta.jsx
C:\ThomasParking\ThomasParking\src\components\Emoji.jsx
C:\ThomasParking\ThomasParking\src\components\ErrorBoundary.jsx
C:\ThomasParking\ThomasParking\src\components\ErrorMessage.jsx
C:\ThomasParking\ThomasParking\src\components\Filtros.jsx
C:\ThomasParking\ThomasParking\src\components\Footer.jsx
C:\ThomasParking\ThomasParking\src\components\ListaRegistros.jsx
C:\ThomasParking\ThomasParking\src\components\Loader.jsx
C:\ThomasParking\ThomasParking\src\components\LoadingOverlay.jsx
C:\ThomasParking\ThomasParking\src\components\LoadingScreen.jsx
C:\ThomasParking\ThomasParking\src\components\Modal.jsx
C:\ThomasParking\ThomasParking\src\components\Navbar.jsx
C:\ThomasParking\ThomasParking\src\components\ResizeImage.jsx
C:\ThomasParking\ThomasParking\src\components\ResumenRegistros.jsx
C:\ThomasParking\ThomasParking\src\components\SelectorDeFoto.jsx
C:\ThomasParking\ThomasParking\src\components\SignUp.jsx
C:\ThomasParking\ThomasParking\src\components\SyncIndicator.jsx
C:\ThomasParking\ThomasParking\src\components\TablaResultados.jsx
C:\ThomasParking\ThomasParking\src\components\ThemeToggle.jsx
C:\ThomasParking\ThomasParking\src\context\ThemeContext.jsx
C:\ThomasParking\ThomasParking\src\context\ViewContext.jsx
C:\ThomasParking\ThomasParking\src\hooks\useHover.jsx
C:\ThomasParking\ThomasParking\src\hooks\useOnlineStatus.jsx
C:\ThomasParking\ThomasParking\src\pages\AcercaDe.jsx
C:\ThomasParking\ThomasParking\src\pages\CapturaFoto.jsx
C:\ThomasParking\ThomasParking\src\pages\Consultas.jsx
C:\ThomasParking\ThomasParking\src\pages\DescargoGestion.jsx
C:\ThomasParking\ThomasParking\src\pages\GestionCopropietarios.jsx
C:\ThomasParking\ThomasParking\src\pages\GestionUsuarios.jsx
C:\ThomasParking\ThomasParking\src\pages\Login.jsx
C:\ThomasParking\ThomasParking\src\pages\RegistroParqueo.jsx
C:\ThomasParking\ThomasParking\src\pages\ResumenRecaudo.jsx
C:\ThomasParking\ThomasParking\src\providers\QueryClientProvider.jsx
C:\ThomasParking\ThomasParking\src\styles\global.css

============================================================



----- C:\ThomasParking\ThomasParking\dist\assets\index-DzlgHYNC.css -----

@charset "UTF-8";.react-datepicker__navigation-icon:before,.react-datepicker__year-read-view--down-arrow,.react-datepicker__month-read-view--down-arrow,.react-datepicker__month-year-read-view--down-arrow{border-color:#ccc;border-style:solid;border-width:3px 3px 0 0;content:"";display:block;height:9px;position:absolute;top:6px;width:9px}.react-datepicker-wrapper{display:inline-block;padding:0;border:0}.react-datepicker{font-family:Helvetica Neue,helvetica,arial,sans-serif;font-size:.8rem;background-color:#fff;color:#000;border:1px solid #aeaeae;border-radius:.3rem;display:inline-block;position:relative;line-height:initial}.react-datepicker--time-only .react-datepicker__time-container{border-left:0}.react-datepicker--time-only .react-datepicker__time,.react-datepicker--time-only .react-datepicker__time-box{border-bottom-left-radius:.3rem;border-bottom-right-radius:.3rem}.react-datepicker-popper{z-index:1;line-height:0}.react-datepicker-popper .react-datepicker__triangle{stroke:#aeaeae}.react-datepicker-popper[data-placement^=bottom] .react-datepicker__triangle{fill:#f0f0f0;color:#f0f0f0}.react-datepicker-popper[data-placement^=top] .react-datepicker__triangle{fill:#fff;color:#fff}.react-datepicker__header{text-align:center;background-color:#f0f0f0;border-bottom:1px solid #aeaeae;border-top-left-radius:.3rem;padding:8px 0;position:relative}.react-datepicker__header--time{padding-bottom:8px;padding-left:5px;padding-right:5px}.react-datepicker__header--time:not(.react-datepicker__header--time--only){border-top-left-radius:0}.react-datepicker__header:not(.react-datepicker__header--has-time-select){border-top-right-radius:.3rem}.react-datepicker__year-dropdown-container--select,.react-datepicker__month-dropdown-container--select,.react-datepicker__month-year-dropdown-container--select,.react-datepicker__year-dropdown-container--scroll,.react-datepicker__month-dropdown-container--scroll,.react-datepicker__month-year-dropdown-container--scroll{display:inline-block;margin:0 15px}.react-datepicker__current-month,.react-datepicker-time__header,.react-datepicker-year-header{margin-top:0;color:#000;font-weight:700;font-size:.944rem}h2.react-datepicker__current-month{padding:0;margin:0}.react-datepicker-time__header{text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.react-datepicker__navigation{align-items:center;background:none;display:flex;justify-content:center;text-align:center;cursor:pointer;position:absolute;top:2px;padding:0;border:none;z-index:1;height:32px;width:32px;text-indent:-999em;overflow:hidden}.react-datepicker__navigation--previous{left:2px}.react-datepicker__navigation--next{right:2px}.react-datepicker__navigation--next--with-time:not(.react-datepicker__navigation--next--with-today-button){right:85px}.react-datepicker__navigation--years{position:relative;top:0;display:block;margin-left:auto;margin-right:auto}.react-datepicker__navigation--years-previous{top:4px}.react-datepicker__navigation--years-upcoming{top:-4px}.react-datepicker__navigation:hover *:before{border-color:#a6a6a6}.react-datepicker__navigation-icon{position:relative;top:-1px;font-size:20px;width:0}.react-datepicker__navigation-icon--next{left:-2px}.react-datepicker__navigation-icon--next:before{transform:rotate(45deg);left:-7px}.react-datepicker__navigation-icon--previous{right:-2px}.react-datepicker__navigation-icon--previous:before{transform:rotate(225deg);right:-7px}.react-datepicker__month-container{float:left}.react-datepicker__year{margin:.4rem;text-align:center}.react-datepicker__year-wrapper{display:flex;flex-wrap:wrap;max-width:180px}.react-datepicker__year .react-datepicker__year-text{display:inline-block;width:4rem;margin:2px}.react-datepicker__month{margin:.4rem;text-align:center}.react-datepicker__month .react-datepicker__month-text,.react-datepicker__month .react-datepicker__quarter-text{display:inline-block;width:4rem;margin:2px}.react-datepicker__input-time-container{clear:both;width:100%;float:left;margin:5px 0 10px 15px;text-align:left}.react-datepicker__input-time-container .react-datepicker-time__caption,.react-datepicker__input-time-container .react-datepicker-time__input-container{display:inline-block}.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input{display:inline-block;margin-left:10px}.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input{width:auto}.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input[type=time]::-webkit-inner-spin-button,.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input[type=time]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__input input[type=time]{-moz-appearance:textfield}.react-datepicker__input-time-container .react-datepicker-time__input-container .react-datepicker-time__delimiter{margin-left:5px;display:inline-block}.react-datepicker__time-container{float:right;border-left:1px solid #aeaeae;width:85px}.react-datepicker__time-container--with-today-button{display:inline;border:1px solid #aeaeae;border-radius:.3rem;position:absolute;right:-87px;top:0}.react-datepicker__time-container .react-datepicker__time{position:relative;background:#fff;border-bottom-right-radius:.3rem}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box{width:85px;overflow-x:hidden;margin:0 auto;text-align:center;border-bottom-right-radius:.3rem}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list{list-style:none;margin:0;height:calc(195px + .85rem);overflow-y:scroll;padding-right:0;padding-left:0;width:100%;box-sizing:content-box}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item{height:30px;padding:5px 10px;white-space:nowrap}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item:hover{cursor:pointer;background-color:#f0f0f0}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--selected{background-color:#216ba5;color:#fff;font-weight:700}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--selected:hover{background-color:#216ba5}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--disabled{color:#ccc}.react-datepicker__time-container .react-datepicker__time .react-datepicker__time-box ul.react-datepicker__time-list li.react-datepicker__time-list-item--disabled:hover{cursor:default;background-color:transparent}.react-datepicker__week-number{color:#ccc;display:inline-block;width:1.7rem;line-height:1.7rem;text-align:center;margin:.166rem}.react-datepicker__week-number.react-datepicker__week-number--clickable{cursor:pointer}.react-datepicker__week-number.react-datepicker__week-number--clickable:not(.react-datepicker__week-number--selected):hover{border-radius:.3rem;background-color:#f0f0f0}.react-datepicker__week-number--selected{border-radius:.3rem;background-color:#216ba5;color:#fff}.react-datepicker__week-number--selected:hover{background-color:#1d5d90}.react-datepicker__day-names{white-space:nowrap;margin-bottom:-8px}.react-datepicker__week{white-space:nowrap}.react-datepicker__day-name,.react-datepicker__day,.react-datepicker__time-name{color:#000;display:inline-block;width:1.7rem;line-height:1.7rem;text-align:center;margin:.166rem}.react-datepicker__day,.react-datepicker__month-text,.react-datepicker__quarter-text,.react-datepicker__year-text{cursor:pointer}.react-datepicker__day:not([aria-disabled=true]):hover,.react-datepicker__month-text:not([aria-disabled=true]):hover,.react-datepicker__quarter-text:not([aria-disabled=true]):hover,.react-datepicker__year-text:not([aria-disabled=true]):hover{border-radius:.3rem;background-color:#f0f0f0}.react-datepicker__day--today,.react-datepicker__month-text--today,.react-datepicker__quarter-text--today,.react-datepicker__year-text--today{font-weight:700}.react-datepicker__day--highlighted,.react-datepicker__month-text--highlighted,.react-datepicker__quarter-text--highlighted,.react-datepicker__year-text--highlighted{border-radius:.3rem;background-color:#3dcc4a;color:#fff}.react-datepicker__day--highlighted:not([aria-disabled=true]):hover,.react-datepicker__month-text--highlighted:not([aria-disabled=true]):hover,.react-datepicker__quarter-text--highlighted:not([aria-disabled=true]):hover,.react-datepicker__year-text--highlighted:not([aria-disabled=true]):hover{background-color:#32be3f}.react-datepicker__day--highlighted-custom-1,.react-datepicker__month-text--highlighted-custom-1,.react-datepicker__quarter-text--highlighted-custom-1,.react-datepicker__year-text--highlighted-custom-1{color:#f0f}.react-datepicker__day--highlighted-custom-2,.react-datepicker__month-text--highlighted-custom-2,.react-datepicker__quarter-text--highlighted-custom-2,.react-datepicker__year-text--highlighted-custom-2{color:green}.react-datepicker__day--holidays,.react-datepicker__month-text--holidays,.react-datepicker__quarter-text--holidays,.react-datepicker__year-text--holidays{position:relative;border-radius:.3rem;background-color:#ff6803;color:#fff}.react-datepicker__day--holidays .overlay,.react-datepicker__month-text--holidays .overlay,.react-datepicker__quarter-text--holidays .overlay,.react-datepicker__year-text--holidays .overlay{position:absolute;bottom:100%;left:50%;transform:translate(-50%);background-color:#333;color:#fff;padding:4px;border-radius:4px;white-space:nowrap;visibility:hidden;opacity:0;transition:visibility 0s,opacity .3s ease-in-out}.react-datepicker__day--holidays:not([aria-disabled=true]):hover,.react-datepicker__month-text--holidays:not([aria-disabled=true]):hover,.react-datepicker__quarter-text--holidays:not([aria-disabled=true]):hover,.react-datepicker__year-text--holidays:not([aria-disabled=true]):hover{background-color:#cf5300}.react-datepicker__day--holidays:hover .overlay,.react-datepicker__month-text--holidays:hover .overlay,.react-datepicker__quarter-text--holidays:hover .overlay,.react-datepicker__year-text--holidays:hover .overlay{visibility:visible;opacity:1}.react-datepicker__day--selected,.react-datepicker__day--in-selecting-range,.react-datepicker__day--in-range,.react-datepicker__month-text--selected,.react-datepicker__month-text--in-selecting-range,.react-datepicker__month-text--in-range,.react-datepicker__quarter-text--selected,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__quarter-text--in-range,.react-datepicker__year-text--selected,.react-datepicker__year-text--in-selecting-range,.react-datepicker__year-text--in-range{border-radius:.3rem;background-color:#216ba5;color:#fff}.react-datepicker__day--selected:not([aria-disabled=true]):hover,.react-datepicker__day--in-selecting-range:not([aria-disabled=true]):hover,.react-datepicker__day--in-range:not([aria-disabled=true]):hover,.react-datepicker__month-text--selected:not([aria-disabled=true]):hover,.react-datepicker__month-text--in-selecting-range:not([aria-disabled=true]):hover,.react-datepicker__month-text--in-range:not([aria-disabled=true]):hover,.react-datepicker__quarter-text--selected:not([aria-disabled=true]):hover,.react-datepicker__quarter-text--in-selecting-range:not([aria-disabled=true]):hover,.react-datepicker__quarter-text--in-range:not([aria-disabled=true]):hover,.react-datepicker__year-text--selected:not([aria-disabled=true]):hover,.react-datepicker__year-text--in-selecting-range:not([aria-disabled=true]):hover,.react-datepicker__year-text--in-range:not([aria-disabled=true]):hover{background-color:#1d5d90}.react-datepicker__day--keyboard-selected,.react-datepicker__month-text--keyboard-selected,.react-datepicker__quarter-text--keyboard-selected,.react-datepicker__year-text--keyboard-selected{border-radius:.3rem;background-color:#bad9f1;color:#000}.react-datepicker__day--keyboard-selected:not([aria-disabled=true]):hover,.react-datepicker__month-text--keyboard-selected:not([aria-disabled=true]):hover,.react-datepicker__quarter-text--keyboard-selected:not([aria-disabled=true]):hover,.react-datepicker__year-text--keyboard-selected:not([aria-disabled=true]):hover{background-color:#1d5d90}.react-datepicker__day--in-selecting-range:not(.react-datepicker__day--in-range,.react-datepicker__month-text--in-range,.react-datepicker__quarter-text--in-range,.react-datepicker__year-text--in-range),.react-datepicker__month-text--in-selecting-range:not(.react-datepicker__day--in-range,.react-datepicker__month-text--in-range,.react-datepicker__quarter-text--in-range,.react-datepicker__year-text--in-range),.react-datepicker__quarter-text--in-selecting-range:not(.react-datepicker__day--in-range,.react-datepicker__month-text--in-range,.react-datepicker__quarter-text--in-range,.react-datepicker__year-text--in-range),.react-datepicker__year-text--in-selecting-range:not(.react-datepicker__day--in-range,.react-datepicker__month-text--in-range,.react-datepicker__quarter-text--in-range,.react-datepicker__year-text--in-range){background-color:#216ba580}.react-datepicker__month--selecting-range .react-datepicker__day--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range),.react-datepicker__year--selecting-range .react-datepicker__day--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range),.react-datepicker__month--selecting-range .react-datepicker__month-text--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range),.react-datepicker__year--selecting-range .react-datepicker__month-text--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range),.react-datepicker__month--selecting-range .react-datepicker__quarter-text--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range),.react-datepicker__year--selecting-range .react-datepicker__quarter-text--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range),.react-datepicker__month--selecting-range .react-datepicker__year-text--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range),.react-datepicker__year--selecting-range .react-datepicker__year-text--in-range:not(.react-datepicker__day--in-selecting-range,.react-datepicker__month-text--in-selecting-range,.react-datepicker__quarter-text--in-selecting-range,.react-datepicker__year-text--in-selecting-range){background-color:#f0f0f0;color:#000}.react-datepicker__day--disabled,.react-datepicker__month-text--disabled,.react-datepicker__quarter-text--disabled,.react-datepicker__year-text--disabled{cursor:default;color:#ccc}.react-datepicker__day--disabled .overlay,.react-datepicker__month-text--disabled .overlay,.react-datepicker__quarter-text--disabled .overlay,.react-datepicker__year-text--disabled .overlay{position:absolute;bottom:70%;left:50%;transform:translate(-50%);background-color:#333;color:#fff;padding:4px;border-radius:4px;white-space:nowrap;visibility:hidden;opacity:0;transition:visibility 0s,opacity .3s ease-in-out}.react-datepicker__input-container{position:relative;display:inline-block;width:100%}.react-datepicker__input-container .react-datepicker__calendar-icon{position:absolute;padding:.5rem;box-sizing:content-box}.react-datepicker__view-calendar-icon input{padding:6px 10px 5px 25px}.react-datepicker__year-read-view,.react-datepicker__month-read-view,.react-datepicker__month-year-read-view{border:1px solid transparent;border-radius:.3rem;position:relative}.react-datepicker__year-read-view:hover,.react-datepicker__month-read-view:hover,.react-datepicker__month-year-read-view:hover{cursor:pointer}.react-datepicker__year-read-view:hover .react-datepicker__year-read-view--down-arrow,.react-datepicker__year-read-view:hover .react-datepicker__month-read-view--down-arrow,.react-datepicker__month-read-view:hover .react-datepicker__year-read-view--down-arrow,.react-datepicker__month-read-view:hover .react-datepicker__month-read-view--down-arrow,.react-datepicker__month-year-read-view:hover .react-datepicker__year-read-view--down-arrow,.react-datepicker__month-year-read-view:hover .react-datepicker__month-read-view--down-arrow{border-top-color:#b3b3b3}.react-datepicker__year-read-view--down-arrow,.react-datepicker__month-read-view--down-arrow,.react-datepicker__month-year-read-view--down-arrow{transform:rotate(135deg);right:-16px;top:0}.react-datepicker__year-dropdown,.react-datepicker__month-dropdown,.react-datepicker__month-year-dropdown{background-color:#f0f0f0;position:absolute;width:50%;left:25%;top:30px;z-index:1;text-align:center;border-radius:.3rem;border:1px solid #aeaeae}.react-datepicker__year-dropdown:hover,.react-datepicker__month-dropdown:hover,.react-datepicker__month-year-dropdown:hover{cursor:pointer}.react-datepicker__year-dropdown--scrollable,.react-datepicker__month-dropdown--scrollable,.react-datepicker__month-year-dropdown--scrollable{height:150px;overflow-y:scroll}.react-datepicker__year-option,.react-datepicker__month-option,.react-datepicker__month-year-option{line-height:20px;width:100%;display:block;margin-left:auto;margin-right:auto}.react-datepicker__year-option:first-of-type,.react-datepicker__month-option:first-of-type,.react-datepicker__month-year-option:first-of-type{border-top-left-radius:.3rem;border-top-right-radius:.3rem}.react-datepicker__year-option:last-of-type,.react-datepicker__month-option:last-of-type,.react-datepicker__month-year-option:last-of-type{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border-bottom-left-radius:.3rem;border-bottom-right-radius:.3rem}.react-datepicker__year-option:hover,.react-datepicker__month-option:hover,.react-datepicker__month-year-option:hover{background-color:#ccc}.react-datepicker__year-option:hover .react-datepicker__navigation--years-upcoming,.react-datepicker__month-option:hover .react-datepicker__navigation--years-upcoming,.react-datepicker__month-year-option:hover .react-datepicker__navigation--years-upcoming{border-bottom-color:#b3b3b3}.react-datepicker__year-option:hover .react-datepicker__navigation--years-previous,.react-datepicker__month-option:hover .react-datepicker__navigation--years-previous,.react-datepicker__month-year-option:hover .react-datepicker__navigation--years-previous{border-top-color:#b3b3b3}.react-datepicker__year-option--selected,.react-datepicker__month-option--selected,.react-datepicker__month-year-option--selected{position:absolute;left:15px}.react-datepicker__close-icon{cursor:pointer;background-color:transparent;border:0;outline:0;padding:0 6px 0 0;position:absolute;top:0;right:0;height:100%;display:table-cell;vertical-align:middle}.react-datepicker__close-icon:after{cursor:pointer;background-color:#216ba5;color:#fff;border-radius:50%;height:16px;width:16px;padding:2px;font-size:12px;line-height:1;text-align:center;display:table-cell;vertical-align:middle;content:"√ó"}.react-datepicker__close-icon--disabled{cursor:default}.react-datepicker__close-icon--disabled:after{cursor:default;background-color:#ccc}.react-datepicker__today-button{background:#f0f0f0;border-top:1px solid #aeaeae;cursor:pointer;text-align:center;font-weight:700;padding:5px 0;clear:left}.react-datepicker__portal{position:fixed;width:100vw;height:100vh;background-color:#000c;left:0;top:0;justify-content:center;align-items:center;display:flex;z-index:2147483647}.react-datepicker__portal .react-datepicker__day-name,.react-datepicker__portal .react-datepicker__day,.react-datepicker__portal .react-datepicker__time-name{width:3rem;line-height:3rem}@media (max-width: 400px),(max-height: 550px){.react-datepicker__portal .react-datepicker__day-name,.react-datepicker__portal .react-datepicker__day,.react-datepicker__portal .react-datepicker__time-name{width:2rem;line-height:2rem}}.react-datepicker__portal .react-datepicker__current-month,.react-datepicker__portal .react-datepicker-time__header{font-size:1.44rem}.react-datepicker__children-container{width:13.8rem;margin:.4rem;padding-right:.2rem;padding-left:.2rem;height:auto}.react-datepicker__aria-live{position:absolute;clip-path:circle(0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;width:1px;white-space:nowrap}.react-datepicker__calendar-icon{width:1em;height:1em;vertical-align:-.125em}:root{--background: #f8fafc;--surface: #fff;--text: #18181b;--text-muted: #6b7280;--primary: #6366f1;--primary-light: #e0e7ff;--secondary: #38bdf8;--accent: #ff6f91;--success: #10b981;--warning: #f59e42;--danger: #ef4444;--radius-lg: 20px;--radius-md: 12px;--radius-sm: 6px;--shadow-lg: 0 8px 32px #6366f133;--shadow-md: 0 2px 12px #6366f144;--transition: .22s cubic-bezier(.4,0,.2,1);--font-main: "Inter", "Segoe UI", Arial, sans-serif;--focus: #ff6f91}[data-theme=dark]{--background: #18181b;--surface: #23272f;--text: #f3f4f6;--text-muted: #a1a1aa;--primary: #818cf8;--primary-light: #23272f;--secondary: #38bdf8;--accent: #f472b6;--shadow-lg: 0 8px 32px #818cf833;--shadow-md: 0 2px 12px #818cf844}html,body{margin:0;padding:0;font-family:var(--font-main);background:var(--background);color:var(--text);min-height:100vh;scroll-behavior:smooth;text-align:center;transition:background var(--transition),color var(--transition);-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}#root,.app-root{min-height:100vh;display:flex;flex-direction:column;align-items:center;background:var(--background)}a{color:var(--primary);text-decoration:none;transition:color var(--transition)}a:hover,a:focus{color:var(--accent);text-decoration:underline;outline-offset:2px;outline:2px solid var(--accent)}h1,h2,h3,h4{font-weight:800;letter-spacing:-1px;margin-top:0;text-align:center;line-height:1.2}button,input,select,textarea{font-family:inherit;font-size:1rem;border-radius:var(--radius-md);border:1.5px solid #e5e7eb;padding:10px 14px;outline-offset:2px;transition:border-color var(--transition),background var(--transition),box-shadow var(--transition);margin:.25rem 0;box-sizing:border-box}button{cursor:pointer;background:var(--primary);color:#fff;border:none;font-weight:600;box-shadow:var(--shadow-md);min-width:120px;min-height:44px;display:inline-flex;align-items:center;justify-content:center;gap:8px;-webkit-user-select:none;user-select:none}button:hover,button:focus{background:linear-gradient(90deg,var(--secondary) 60%,var(--accent) 100%);outline:none;box-shadow:0 0 0 3px var(--focus)}button:focus-visible{outline:3px solid var(--focus);outline-offset:3px}button[aria-label="Abrir men√∫"],button[aria-label="Cerrar men√∫"],.btn-hamburguesa{min-width:0!important;min-height:0!important;width:32px!important;height:32px!important;padding:4px!important;box-shadow:none!important}input:focus,select:focus,textarea:focus{border-color:var(--primary);background:#f0f9ff;box-shadow:0 0 0 3px var(--focus)}input[type=checkbox],input[type=radio]{width:1.1em;height:1.1em;accent-color:var(--primary);margin-right:7px;cursor:pointer}::-webkit-scrollbar{width:10px;background:#e0e7ef}::-webkit-scrollbar-thumb{background:var(--primary);border-radius:8px}.thumbnail{width:38px;height:38px;object-fit:cover;border-radius:var(--radius-sm);box-shadow:0 2px 6px #6366f133}.modal-backdrop{position:fixed;top:0;left:0;width:100vw;height:100vh;background:#18181bbf;display:flex;justify-content:center;align-items:center;z-index:9999}.modal-content{background:var(--surface);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);padding:2rem;max-width:480px;width:90vw;max-height:90vh;overflow-y:auto;text-align:left}.loader-spinner{width:48px;height:48px;border:6px solid #e0e0e0;border-top:6px solid var(--primary);border-radius:50%;animation:spin 1s linear infinite;margin-bottom:1rem;display:flex;align-items:center;justify-content:center;font-size:2rem}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.filtros-grid{flex-direction:column;align-items:center}.filtro-item{min-width:100%}.resultados-table-container{max-height:300px}}.sin-resultados{color:var(--text-muted);font-size:1.1em;text-align:center;padding:1.2em 0}.error-message{background:#fffbe6;color:var(--danger);border:1.5px solid #ffe58f;margin-top:1rem;padding:12px 18px;border-radius:var(--radius-md);font-size:1.06em;font-weight:600;text-align:center;max-width:700px;word-wrap:break-word}.pt-16{padding-top:4rem!important}


----- C:\ThomasParking\ThomasParking\src\App.jsx -----

// src/App.jsx
import React, { useEffect, useState } from 'react';
import { BrowserRouter, Routes, Route, Navigate, useLocation } from 'react-router-dom';
import supabase from './supabaseClient';
import { ThemeProvider } from './context/ThemeContext';

// Componentes principales
import Navbar from './components/Navbar';
import Footer from './components/Footer';
import ErrorBoundary from './components/ErrorBoundary';
import AuthGuard from './components/AuthGuard';
import Loader from './components/Loader';
import useOnlineStatus from './hooks/useOnlineStatus';

// P√°ginas
import RegistroParqueo from './pages/RegistroParqueo';
import Consultas from './pages/Consultas';
import Recaudo from './pages/ResumenRecaudo';
import Descargos from './pages/DescargoGestion';
import GestionUsuarios from './pages/GestionUsuarios';
import GestionCopropietarios from './pages/GestionCopropietarios';
import AcercaDe from './pages/AcercaDe';
import Login from './pages/Login';
import SignUp from './components/SignUp';

function ProtectedRoute({ user, allowedRoles, children }) {
  const location = useLocation();
  
  if (!user) {
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  if (allowedRoles && !allowedRoles.includes(user.user_metadata?.role)) {
    return <Navigate to="/" replace />;
  }

  return children;
}

function AppRoutes({ user, menuOpen, setMenuOpen, isOnline }) {
  const location = useLocation();
  const hideNavbarRoutes = ['/login', '/', '/registro'];

  return (
    <>
      {!hideNavbarRoutes.includes(location.pathname) && (
        <Navbar 
          user={user} 
          menuOpen={menuOpen} 
          setMenuOpen={setMenuOpen} 
        />
      )}

      {!isOnline && (
        <div className="offline-banner" role="status" aria-live="polite"
          style={{
            background: '#fff3cd',
            color: '#856404',
            padding: '10px 0',
            textAlign: 'center',
            fontWeight: 600,
            fontSize: '1rem',
            borderBottom: '1.5px solid #ffe58f',
            position: 'sticky',
            top: '64px',
            zIndex: 40
          }}
        >
          <span role="img" aria-label="offline">‚ö°</span>
          &nbsp;Modo offline: solo lectura. Edici√≥n y borrado deshabilitados.
        </div>
      )}

      {!menuOpen && (
        <div className="pt-16 min-h-screen flex flex-col">
          <Routes>
            <Route path="/login" element={<Login />} />
            <Route path="/registro" element={<SignUp />} />
            
            <Route path="/registros" element={
              <ProtectedRoute user={user} allowedRoles={['admin', 'registrador']}>
                <RegistroParqueo />
              </ProtectedRoute>
            }/>

            <Route path="/consultas" element={
              <ProtectedRoute user={user}>
                <Consultas />
              </ProtectedRoute>
            }/>

            <Route path="/recaudo" element={
              <ProtectedRoute user={user} allowedRoles={['admin', 'registrador']}>
                <Recaudo />
              </ProtectedRoute>
            }/>

            <Route path="/descargos" element={
              <ProtectedRoute user={user} allowedRoles={['admin']}>
                <Descargos />
              </ProtectedRoute>
            }/>

            <Route path="/acercade" element={
              <ProtectedRoute user={user}>
                <AcercaDe />
              </ProtectedRoute>
            }/>

            <Route path="/usuarios" element={
              <ProtectedRoute user={user} allowedRoles={['admin']}>
                <GestionUsuarios />
              </ProtectedRoute>
            }/>

            <Route path="/copropietarios" element={
              <ProtectedRoute user={user} allowedRoles={['admin']}>
                <GestionCopropietarios />
              </ProtectedRoute>
            }/>

            <Route path="/" element={
              user ? <Navigate to="/registros" replace /> : <Navigate to="/login" replace />
            }/>

            <Route path="*" element={<Navigate to="/" replace />} />
          </Routes>
          <Footer />
        </div>
      )}
    </>
  );
}

function App() {
  const [user, setUser] = useState(null);
  const [menuOpen, setMenuOpen] = useState(false);
  const [loading, setLoading] = useState(true);
  const isOnline = useOnlineStatus();

  useEffect(() => {
    let isMounted = true;
    
    const getSession = async () => {
      const { data: { user } } = await supabase.auth.getUser();
      if (isMounted) {
        setUser(user || null);
        setLoading(false);
      }
    };

    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      async (_event, session) => {
        if (isMounted) {
          setUser(session?.user || null);
          setLoading(false);
        }
      }
    );

    getSession();
    return () => {
      isMounted = false;
      subscription?.unsubscribe();
    };
  }, []);

  if (loading) {
    return <Loader fullScreen text="Inicializando aplicaci√≥n..." />;
  }

  return (
    <ThemeProvider>
      <BrowserRouter>
        <ErrorBoundary>
          <AppRoutes
            user={user}
            menuOpen={menuOpen}
            setMenuOpen={setMenuOpen}
            isOnline={isOnline}
          />
        </ErrorBoundary>
      </BrowserRouter>
    </ThemeProvider>
  );
}

export default App;


----- C:\ThomasParking\ThomasParking\src\main.jsx -----

// src/main.jsx
import React from 'react'
import ReactDOM from 'react-dom/client'
import App from './App'
import './styles/global.css'

// Si tienes ThemeProvider propio, descomenta e importa aqu√≠:
import { ThemeProvider } from './context/ThemeContext'

// Registro de Service Worker para PWA (opcional, elimina si no se usa)
if ('serviceWorker' in navigator && import.meta.env.PROD) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/service-worker.js')
      .then(registration => {
        console.log('ServiceWorker registrado con √©xito:', registration.scope)
      })
      .catch(error => {
        console.error('Error al registrar ServiceWorker:', error)
      })
  })
}

// Renderizado principal de la app
ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    {/* Si usas ThemeProvider global, envuelve <App /> as√≠:
    <ThemeProvider>
      <App />
    </ThemeProvider>
    */}
    <App />
  </React.StrictMode>
)


----- C:\ThomasParking\ThomasParking\src\components\AuthGuard.jsx -----

// src/components/AuthGuard.jsx
import React, { useState, useEffect } from 'react';
import { Navigate, useLocation, Outlet } from 'react-router-dom';
import supabase from '../supabaseClient';
import Loader from './Loader';
import ErrorMessage from './ErrorMessage';

export default function AuthGuard({ requiredRole = null }) {
  const location = useLocation();
  const [authState, setAuthState] = useState({
    user: null,
    loading: true,
    error: null,
    role: null
  });

  const checkAuthorization = async (user) => {
    try {
      // 1. Obtener rol desde la tabla usuarios_app
      const { data, error } = await supabase
        .from('usuarios_app')
        .select('email, rol, activo')
        .eq('email', user.email)
        .single();

      if (error) throw new Error('Error de autorizaci√≥n: ' + error.message);
      if (!data) throw new Error('Usuario no registrado en el sistema');
      if (!data.activo) throw new Error('Cuenta desactivada');

      // 2. Actualizar metadata del usuario en Supabase
      const { error: updateError } = await supabase.auth.updateUser({
        data: { role: data.rol }
      });

      if (updateError) throw new Error('Error actualizando perfil: ' + updateError.message);

      return { ...user, role: data.rol };
    } catch (error) {
      await supabase.auth.signOut();
      throw error;
    }
  };

  useEffect(() => {
    let isMounted = true;
    const timeout = setTimeout(() => {
      if (isMounted && authState.loading) {
        setAuthState(prev => ({
          ...prev,
          loading: false,
          error: 'Timeout al verificar credenciales'
        }));
      }
    }, 15000);

    const { data: { subscription } } = supabase.auth.onAuthStateChange(
      async (event, session) => {
        try {
          if (!session?.user) {
            if (isMounted) {
              setAuthState({
                user: null,
                loading: false,
                error: null,
                role: null
              });
            }
            return;
          }

          const authorizedUser = await checkAuthorization(session.user);
          if (isMounted) {
            setAuthState({
              user: authorizedUser,
              loading: false,
              error: null,
              role: authorizedUser.role
            });
          }
        } catch (error) {
          if (isMounted) {
            setAuthState({
              user: null,
              loading: false,
              error: error.message,
              role: null
            });
          }
        }
      }
    );

    const initializeAuth = async () => {
      try {
        const { data: { user }, error } = await supabase.auth.getUser();
        
        if (!isMounted) return;
        if (error) throw error;
        if (!user) throw new Error('No autenticado');

        const authorizedUser = await checkAuthorization(user);
        if (isMounted) {
          setAuthState({
            user: authorizedUser,
            loading: false,
            error: null,
            role: authorizedUser.role
          });
        }
      } catch (error) {
        if (isMounted) {
          setAuthState({
            user: null,
            loading: false,
            error: error.message,
            role: null
          });
        }
      }
    };

    initializeAuth();
    return () => {
      isMounted = false;
      clearTimeout(timeout);
      subscription?.unsubscribe();
    };
  }, []);

  const handleRetry = async () => {
    setAuthState(prev => ({ ...prev, loading: true, error: null }));
    try {
      const { data: { user }, error } = await supabase.auth.getUser();
      if (error) throw error;
      if (!user) throw new Error('No autenticado');

      const authorizedUser = await checkAuthorization(user);
      setAuthState({
        user: authorizedUser,
        loading: false,
        error: null,
        role: authorizedUser.role
      });
    } catch (error) {
      setAuthState({
        user: null,
        loading: false,
        error: error.message,
        role: null
      });
    }
  };

  if (authState.loading) {
    return <Loader fullScreen text="Verificando credenciales..." />;
  }

  if (authState.error) {
    return (
      <div className="min-h-screen flex flex-col items-center justify-center p-4">
        <ErrorMessage 
          title="Error de acceso"
          message={authState.error}
          retryable
          onRetry={handleRetry}
        >
          <button
            onClick={() => supabase.auth.signOut()}
            className="mt-4 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 transition-colors"
          >
            Cerrar Sesi√≥n
          </button>
        </ErrorMessage>
      </div>
    );
  }

  if (!authState.user) {
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  if (requiredRole && authState.role !== requiredRole) {
    return <Navigate to="/" replace />;
  }

  return <Outlet />;
}


----- C:\ThomasParking\ThomasParking\src\components\CapturaCamara.jsx -----

// src/components/CapturaCamara.jsx
import React, { useState, useEffect, useRef } from 'react'
import Emoji from './Emoji'

export default function CapturaCamara({ onCaptura }) {
  const videoRef = useRef(null)
  const canvasRef = useRef(null)
  const [error, setError] = useState(null)
  const [foto, setFoto] = useState(null)
  const [modoCamara, setModoCamara] = useState('environment')
  const [stream, setStream] = useState(null)

  // Evita scroll en body mientras la c√°mara est√° activa
  useEffect(() => {
    const originalOverflow = document.body.style.overflow
    document.body.style.overflow = 'hidden'
    return () => {
      document.body.style.overflow = originalOverflow
    }
  }, [])

  // Iniciar c√°mara
  useEffect(() => {
    let activo = true
    const iniciarCamara = async () => {
      try {
        const constraints = {
          video: {
            facingMode: modoCamara,
            width: { ideal: 220 },
            height: { ideal: 165 }
          },
          audio: false
        }
        const mediaStream = await navigator.mediaDevices.getUserMedia(constraints)
        if (activo) {
          setStream(mediaStream)
          if (videoRef.current) {
            videoRef.current.srcObject = mediaStream
          }
        }
      } catch (err) {
        setError(`Error de c√°mara: ${err.message}`)
      }
    }
    iniciarCamara()
    return () => {
      activo = false
      if (stream) {
        stream.getTracks().forEach(track => track.stop())
      }
    }
    // eslint-disable-next-line
  }, [modoCamara])

  // Capturar foto
  const capturarFoto = () => {
    const video = videoRef.current
    const canvas = canvasRef.current
    const ctx = canvas.getContext('2d')
    canvas.width = video.videoWidth
    canvas.height = video.videoHeight
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height)
    canvas.toBlob(blob => {
      const file = new File([blob], 'foto-capturada.jpg', { type: 'image/jpeg' })
      setFoto(URL.createObjectURL(file))
      onCaptura(file)
    }, 'image/jpeg', 0.9)
  }

  // Cambiar c√°mara frontal/trasera
  const cambiarCamara = () => {
    setModoCamara(prev => prev === 'user' ? 'environment' : 'user')
  }

  if (error) return (
    <div className="error-camara">
      <Emoji symbol="üì∑" /> {error}
      <div style={{ fontSize: 14, marginTop: 8 }}>
        Aseg√∫rate de permitir el acceso a la c√°mara
      </div>
    </div>
  )

  return (
    <div
      className="contenedor-camara"
      style={{
        position: 'fixed',
        top: 0,
        left: 0,
        width: '100vw',
        height: '100vh',
        background: '#18181b',
        zIndex: 9999,
        overflow: 'hidden',
        display: 'flex',
        flexDirection: 'column',
        alignItems: 'center',
        justifyContent: 'center'
      }}
    >
      {!foto ? (
        <>
          <video
            ref={videoRef}
            autoPlay
            playsInline
            style={{
              width: '100%',
              maxWidth: '220px',
              aspectRatio: '4/3',
              borderRadius: '12px',
              background: '#222',
              transform: modoCamara === 'user' ? 'scaleX(-1)' : 'none',
              boxShadow: '0 2px 16px #0006'
            }}
          />
          <div style={{ display: 'flex', gap: 10, marginTop: 16 }}>
            <button
              type="button"
              onClick={capturarFoto}
              className="btn-capturar"
              style={{ minWidth: 90, fontSize: 18 }}
            >
              <Emoji symbol="üì∏" /> Capturar
            </button>
            <button
              type="button"
              onClick={cambiarCamara}
              className="btn-cambiar-camara"
              style={{ minWidth: 90, fontSize: 18 }}
            >
              <Emoji symbol="üîÑ" /> Cambiar
            </button>
          </div>
        </>
      ) : (
        <>
          <img
            src={foto}
            alt="Previsualizaci√≥n"
            style={{
              width: '100%',
              maxWidth: '220px',
              aspectRatio: '4/3',
              borderRadius: '12px',
              border: '2px solid #e0e0e0',
              boxShadow: '0 2px 16px #0006'
            }}
          />
          <div style={{ marginTop: 16 }}>
            <button
              type="button"
              onClick={() => setFoto(null)}
              className="btn-reintentar"
              style={{ minWidth: 120, fontSize: 18 }}
            >
              <Emoji symbol="üîÑ" /> Volver a tomar
            </button>
          </div>
        </>
      )}
      <canvas ref={canvasRef} style={{ display: 'none' }} />
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\DetalleConsulta.jsx -----

import React from 'react';
import PropTypes from 'prop-types';

const DetalleConsulta = ({ detalle }) => (
  <div className="detalle-container">
    {detalle ? (
      <>
        <h3>Detalles del Parqueo</h3>
        <p><strong>ID:</strong> {detalle.id}</p>
        <p><strong>Nombre:</strong> {detalle.nombre}</p>
        <p><strong>Estado:</strong> {detalle.estado}</p>
        {/* Puedes agregar m√°s campos si lo necesitas */}
      </>
    ) : (
      <p>Seleccione un parqueo para ver detalles</p>
    )}
  </div>
);

DetalleConsulta.propTypes = {
  detalle: PropTypes.object,
};

export default DetalleConsulta;


----- C:\ThomasParking\ThomasParking\src\components\Emoji.jsx -----

// src/components/Emoji.jsx
import React from 'react';
export default function Emoji({ symbol, label }) {
  return (
    <span role="img" aria-label={label} aria-hidden={label ? "false" : "true"}>
      {symbol}
    </span>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\ErrorBoundary.jsx -----

// src/components/ErrorBoundary.jsx
import React from 'react';
import PropTypes from 'prop-types';

export default class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { 
      hasError: false,
      error: null,
      errorInfo: null
    };
  }

  static getDerivedStateFromError(error) {
    return { 
      hasError: true,
      error: error 
    };
  }

  componentDidCatch(error, errorInfo) {
    console.error("Error capturado:", error, errorInfo);
    this.setState({ errorInfo });
    
    // Ejemplo de env√≠o a servicio de monitoreo
    if (process.env.NODE_ENV === 'production') {
      // logErrorToService(error, errorInfo);
    }
  }

  handleRetry = () => {
    this.setState({
      hasError: false,
      error: null,
      errorInfo: null
    });
    
    // Opcional: Recargar la aplicaci√≥n completa
    // window.location.reload();
  };

  render() {
    if (this.state.hasError) {
      return (
        <div className="max-w-lg mx-auto my-16 p-8 bg-red-50 dark:bg-red-900 rounded-lg shadow border border-red-200 dark:border-red-800 text-center">
          <h2 className="text-2xl font-bold text-red-700 dark:text-red-100 mb-2">
            ¬°Algo sali√≥ mal!
          </h2>
          
          {this.state.error && (
            <p className="text-red-600 dark:text-red-300 mb-4">
              {this.state.error.message}
            </p>
          )}

          <button
            onClick={this.handleRetry}
            className="mt-4 px-5 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors"
            aria-label="Reintentar operaci√≥n"
          >
            Reintentar
          </button>

          {process.env.NODE_ENV !== 'production' && this.state.errorInfo && (
            <details className="mt-4 text-xs text-left text-red-500 whitespace-pre-wrap">
              <summary>Detalles t√©cnicos</summary>
              <p className="mt-2">{this.state.errorInfo.componentStack}</p>
            </details>
          )}
        </div>
      );
    }

    return this.props.children;
  }
}

ErrorBoundary.propTypes = {
  children: PropTypes.node.isRequired
};


----- C:\ThomasParking\ThomasParking\src\components\ErrorMessage.jsx -----

// src/components/ErrorMessage.jsx
import React from 'react'

/**
 * ErrorMessage
 * @param {string} title - T√≠tulo del error (opcional)
 * @param {string|React.ReactNode} message - Mensaje de error a mostrar
 * @param {boolean} retryable - Si es true, muestra bot√≥n de reintentar
 * @param {function} onRetry - Funci√≥n a ejecutar al reintentar
 * @param {React.ReactNode} [children] - Elementos adicionales opcionales
 */
export default function ErrorMessage({
  title = 'Ha ocurrido un error',
  message = 'Intenta nuevamente o contacta al administrador.',
  retryable = false,
  onRetry,
  children,
}) {
  return (
    <div
      className="max-w-lg mx-auto my-8 p-6 bg-red-50 dark:bg-red-900 rounded-lg border border-red-200 dark:border-red-800 shadow"
      role="alert"
      aria-live="assertive"
      aria-atomic="true"
    >
      <div className="flex items-center mb-2">
        <svg
          className="h-6 w-6 text-red-600 dark:text-red-400 mr-2 flex-shrink-0"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
          aria-hidden="true"
        >
          <path
            strokeLinecap="round"
            strokeLinejoin="round"
            strokeWidth={2}
            d="M12 8v4m0 4h.01M21 12c0 4.97-4.03 9-9 9s-9-4.03-9-9 4.03-9 9-9 9 4.03 9 9z"
          />
        </svg>
        <h3 className="text-lg font-semibold text-red-800 dark:text-red-100">{title}</h3>
      </div>
      <div className="text-red-700 dark:text-red-200 mb-4 break-words">
        {typeof message === 'string' ? <p>{message}</p> : message}
      </div>
      {children}
      {retryable && typeof onRetry === 'function' && (
        <button
          onClick={onRetry}
          className="mt-2 px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 transition-colors"
        >
          Reintentar
        </button>
      )}
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\Filtros.jsx -----

import React from 'react';
import PropTypes from 'prop-types';

const Filtros = ({ filtros, onChange }) => (
  <div className="filtros-section">
    <input
      type="text"
      value={filtros.texto}
      onChange={e => onChange({ ...filtros, texto: e.target.value })}
      placeholder="Buscar parqueo..."
    />
    {/* Aqu√≠ puedes a√±adir m√°s filtros si lo necesitas */}
  </div>
);

Filtros.propTypes = {
  filtros: PropTypes.object.isRequired,
  onChange: PropTypes.func.isRequired,
};

export default Filtros;


----- C:\ThomasParking\ThomasParking\src\components\Footer.jsx -----

// src/components/Footer.jsx
import React from 'react'

export default function Footer() {
  const year = new Date().getFullYear()

  return (
    <footer className="w-full py-6 mt-10 bg-gray-100 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700">
      <div className="container mx-auto flex flex-col md:flex-row items-center justify-between px-4">
        <div className="text-sm text-gray-500 dark:text-gray-400 text-center md:text-left">
          ¬© {year} Conjunto Habitacional Thomas II. Todos los derechos reservados.
        </div>
        <div className="flex space-x-4 mt-2 md:mt-0">
          {/* Puedes agregar enlaces a pol√≠ticas, contacto, etc. */}
          <a
            href="mailto:admin@thomas2.com"
            className="text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors text-sm"
            aria-label="Contacto por correo"
          >
            Contacto
          </a>
          <a
            href="https://github.com/tu-usuario/tu-repo"
            target="_blank"
            rel="noopener noreferrer"
            className="text-gray-500 hover:text-blue-600 dark:hover:text-blue-400 transition-colors text-sm"
            aria-label="Repositorio en GitHub"
          >
            GitHub
          </a>
        </div>
      </div>
    </footer>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\ListaRegistros.jsx -----

// src/components/ListaRegistros.jsx
import React, { useEffect, useState } from 'react'
import { useLocation } from 'react-router-dom'
import supabase from '../supabaseClient'
import Loader from './Loader'
import Emoji from './Emoji'
import dayjs from 'dayjs'
import useOnlineStatus from '../hooks/useOnlineStatus'

export default function ListaRegistros({ refreshKey, onRegistrosFiltradosChange }) {
  const location = useLocation()
  const [registros, setRegistros] = useState([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)
  const [copropietarios, setCopropietarios] = useState([])
  const [filtros, setFiltros] = useState({ propiedad: '', unidadAsignada: '' })
  const [editModal, setEditModal] = useState({ open: false, registro: null })
  const [editData, setEditData] = useState({})
  const [eliminandoAudio, setEliminandoAudio] = useState(false)
  const [savingEdit, setSavingEdit] = useState(false)
  const [deleting, setDeleting] = useState(false)
  const isOnline = useOnlineStatus()

  // Cargar copropietarios
  useEffect(() => {
    let isMounted = true
    const fetchCopropietarios = async () => {
      const { data, error } = await supabase
        .from('copropietarios')
        .select('id, nombre, propiedad, unidad_asignada')
      if (!error && isMounted) setCopropietarios(data)
    }
    fetchCopropietarios()
    return () => { isMounted = false }
  }, [])

  // Cargar registros (se recarga con refreshKey, estado online, y cambio de ruta)
  useEffect(() => {
    let isMounted = true
    setLoading(true)
    setError(null)
    const fetchRegistros = async () => {
      try {
        if (isOnline) {
          const { data, error } = await supabase
            .from('registros_parqueadero')
            .select(`
              id,
              placa_vehiculo,
              tipo_vehiculo,
              fecha_hora_ingreso,
              observaciones,
              foto_url,
              monto,
              gratis,
              recaudado,
              fecha_recaudo,
              dependencia_id,
              observacion_audio_url,
              copropietarios:dependencia_id(nombre, propiedad, unidad_asignada),
              usuario:usuario_id!inner(id, nombre)
            `)
            .order('fecha_hora_ingreso', { ascending: false })
          if (error) throw error
          if (isMounted) {
            setRegistros(data)
            localStorage.setItem('registros_offline', JSON.stringify(data || []))
          }
        } else {
          const localData = JSON.parse(localStorage.getItem('registros_offline') || '[]')
          if (isMounted) setRegistros(localData)
        }
      } catch (error) {
        if (isMounted) setError(error.message)
      } finally {
        if (isMounted) setLoading(false)
      }
    }
    fetchRegistros()
    return () => { isMounted = false; setLoading(true) }
  }, [refreshKey, isOnline, location.pathname])

  // Opciones para selects
  const propiedades = [...new Set(copropietarios.map(c => c.propiedad))].sort()
  const unidadesFiltradas = filtros.propiedad
    ? [...new Set(copropietarios.filter(c => c.propiedad === filtros.propiedad).map(c => c.unidad_asignada))]
    : []

  // Filtros
  const handleFiltroChange = (e) => {
    const { name, value } = e.target
    setFiltros(prev => ({
      ...prev,
      [name]: value,
      ...(name === 'propiedad' && { unidadAsignada: '' })
    }))
  }

  const registrosFiltrados = registros.filter(reg => {
    const coincideProp = !filtros.propiedad || (reg.copropietarios?.propiedad || '') === filtros.propiedad
    const coincideUnidad = !filtros.unidadAsignada || (reg.copropietarios?.unidad_asignada || '') === filtros.unidadAsignada
    return coincideProp && coincideUnidad
  })

  useEffect(() => {
    if (onRegistrosFiltradosChange) {
      onRegistrosFiltradosChange(registrosFiltrados)
    }
  }, [registrosFiltrados, onRegistrosFiltradosChange])

  const totalMonto = registrosFiltrados.reduce(
    (acc, reg) => acc + Number(reg.monto || 0),
    0
  )

  // Edici√≥n
  const handleEdit = (registro) => {
    setEditModal({ open: true, registro })
    setEditData({
      placa_vehiculo: registro.placa_vehiculo,
      tipo_vehiculo: registro.tipo_vehiculo,
      fecha_hora_ingreso: registro.fecha_hora_ingreso ? registro.fecha_hora_ingreso.slice(0, 10) : '',
      gratis: !!registro.gratis,
      observaciones: registro.observaciones || '',
      dependencia_id: registro.dependencia_id,
      recaudado: !!registro.recaudado,
      fecha_recaudo: registro.fecha_recaudo || '',
      observacion_audio_url: registro.observacion_audio_url || '',
      nuevoAudio: null
    })
  }

  const handleEditChange = (e) => {
    const { name, value, type, checked } = e.target
    setEditData(prev => ({
      ...prev,
      [name]: type === 'checkbox' ? checked : value,
      ...(name === 'recaudado' && !checked ? { fecha_recaudo: '' } : {})
    }))
  }

  const handleEditSave = async (e) => {
    e.preventDefault()
    setSavingEdit(true)
    const id = editModal.registro.id
    const monto = editData.gratis ? 0 : (editData.tipo_vehiculo === 'carro' ? 1.00 : 0.50)
    let audioUrlFinal = editData.observacion_audio_url

    // Subida de nuevo audio
    if (editData.nuevoAudio) {
      const fileName = `audio_obs_edit_${editData.placa_vehiculo}_${Date.now()}.webm`
      const { error: uploadError } = await supabase
        .storage
        .from('evidencias-parqueadero')
        .upload(fileName, editData.nuevoAudio, { contentType: 'audio/webm' })
      if (uploadError) {
        setError('Error al subir el audio: ' + uploadError.message)
        setSavingEdit(false)
        return
      }
      const { data: publicUrlData } = supabase
        .storage
        .from('evidencias-parqueadero')
        .getPublicUrl(fileName)
      audioUrlFinal = publicUrlData.publicUrl
    }

    try {
      const { error } = await supabase
        .from('registros_parqueadero')
        .update({
          ...editData,
          monto,
          fecha_recaudo: editData.recaudado ? editData.fecha_recaudo : null,
          observacion_audio_url: audioUrlFinal
        })
        .eq('id', id)

      if (error) throw error

      setRegistros(registros.map(r =>
        r.id === id ? { ...r, ...editData, monto, observacion_audio_url: audioUrlFinal } : r
      ))

      if (!isOnline) {
        const localData = JSON.parse(localStorage.getItem('registros_offline') || '[]')
        const updatedData = localData.map(item =>
          item.id === id ? { ...item, ...editData, monto, observacion_audio_url: audioUrlFinal } : item
        )
        localStorage.setItem('registros_offline', JSON.stringify(updatedData))
      }

      setEditModal({ open: false, registro: null })
      setEditData({})
    } catch (error) {
      setError(error.message)
    } finally {
      setSavingEdit(false)
    }
  }

  // Eliminar audio
  const handleEliminarAudio = async () => {
    if (!editData.observacion_audio_url) return
    if (!window.confirm('¬øEliminar esta evidencia auditiva?')) return
    setEliminandoAudio(true)
    try {
      if (editData.observacion_audio_url && editData.observacion_audio_url !== 'pendiente-sync') {
        const urlParts = editData.observacion_audio_url.split('/')
        const fileName = urlParts[urlParts.length - 1]
        const { error: deleteError } = await supabase
          .storage
          .from('evidencias-parqueadero')
          .remove([fileName])
        if (deleteError) throw deleteError
      }
      setEditData(prev => ({ ...prev, observacion_audio_url: '', nuevoAudio: null }))
      const id = editModal.registro.id
      await supabase
        .from('registros_parqueadero')
        .update({ observacion_audio_url: null })
        .eq('id', id)
      setRegistros(registros.map(r =>
        r.id === id ? { ...r, observacion_audio_url: null } : r
      ))
    } catch (error) {
      setError('Error eliminando audio: ' + error.message)
    }
    setEliminandoAudio(false)
  }

  const handleDelete = async (registro) => {
    if (!window.confirm('¬øSeguro que deseas eliminar este registro?')) return
    setDeleting(true)
    try {
      if (isOnline) {
        const { error } = await supabase
          .from('registros_parqueadero')
          .delete()
          .eq('id', registro.id)
        if (error) throw error
      }

      const updatedRegistros = registros.filter(r => r.id !== registro.id)
      setRegistros(updatedRegistros)
      if (!isOnline) {
        const localData = JSON.parse(localStorage.getItem('registros_offline') || '[]')
        const filteredData = localData.filter(item => item.id !== registro.id)
        localStorage.setItem('registros_offline', JSON.stringify(filteredData))
      }
    } catch (err) {
      setError('Error eliminando registro: ' + err.message)
    } finally {
      setDeleting(false)
    }
  }

  if (loading) return <Loader text="Cargando registros..." />
  if (error) return <div className="error-message">{error}</div>

  return (
    <div className="lista-registros-container">
      <div className="offline-banner" style={{
        display: !isOnline ? 'flex' : 'none',
        background: '#fff3cd',
        color: '#856404',
        padding: '8px 16px',
        borderRadius: '8px',
        marginBottom: '16px',
        alignItems: 'center',
        gap: '8px'
      }}>
        <Emoji symbol="‚ö°" /> Modo offline - Mostrando datos almacenados localmente
      </div>

      <h2>
        <Emoji symbol="üìù" label="√öltimos Registros" /> √öltimos Registros
      </h2>

      <div style={{ display: 'flex', gap: 16, marginBottom: 16 }}>
        <div>
          <label>Propiedad:</label>
          <select
            name="propiedad"
            value={filtros.propiedad}
            onChange={handleFiltroChange}
          >
            <option value="">Todas</option>
            {propiedades.map(prop => (
              <option key={prop} value={prop}>{prop}</option>
            ))}
          </select>
        </div>
        <div>
          <label>Unidad asignada:</label>
          <select
            name="unidadAsignada"
            value={filtros.unidadAsignada}
            onChange={handleFiltroChange}
            disabled={!filtros.propiedad}
          >
            <option value="">Todas</option>
            {unidadesFiltradas.map(unidad => (
              <option key={unidad} value={unidad}>{unidad}</option>
            ))}
          </select>
        </div>
      </div>

      <div className="registros-table-wrapper">
        <table className="registros-table">
          <thead>
            <tr>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üìÖ" /> Fecha/Hora</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üöó" /> Placa</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üèçÔ∏è" /> Tipo</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üìù" /> Observaciones</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üíµ" /> Monto</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üÜì" /> Gratis</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üîó" /> Recaudado</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üìÖ" /> Fecha Recaudo</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üè†" /> Copropietario</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üë§" /> Registrado por</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üì∑" /> Foto</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="üîä" /> Audio</th>
              <th style={{ textAlign: 'center' }}><Emoji symbol="‚öôÔ∏è" /> Acciones</th>
            </tr>
          </thead>
          <tbody>
            {registrosFiltrados.length > 0 ? (
              <>
                {registrosFiltrados.map(reg => (
                  <tr key={reg.id}>
                    <td style={{ textAlign: 'center' }}>
                      {reg.fecha_hora_ingreso
                        ? dayjs(reg.fecha_hora_ingreso).format('DD/MM/YYYY HH:mm')
                        : ''}
                    </td>
                    <td style={{ textAlign: 'center' }}>{reg.placa_vehiculo}</td>
                    <td style={{ textAlign: 'center' }}>
                      {reg.tipo_vehiculo?.toLowerCase() === 'carro' && (
                        <Emoji symbol="üöó" label="Carro" />
                      )}
                      {reg.tipo_vehiculo?.toLowerCase() === 'moto' && (
                        <Emoji symbol="üèçÔ∏è" label="Moto" />
                      )}
                      <span style={{ marginLeft: 6, textTransform: 'capitalize' }}>
                        {reg.tipo_vehiculo}
                      </span>
                    </td>
                    <td>{reg.observaciones || '-'}</td>
                    <td style={{ textAlign: 'center' }}>${Number(reg.monto).toFixed(2)}</td>
                    <td style={{ textAlign: 'center' }}>
                      {reg.gratis
                        ? <Emoji symbol="üÜì" label="Gratis" />
                        : <Emoji symbol="‚ùå" label="No Gratis" />}
                    </td>
                    <td style={{ textAlign: 'center' }}>
                      {reg.recaudado
                        ? <Emoji symbol="üîó" label="Recaudado" />
                        : <Emoji symbol="‚è≥" label="Pendiente" />}
                    </td>
                    <td style={{ textAlign: 'center' }}>
                      {reg.fecha_recaudo || '-'}
                    </td>
                    <td>
                      <Emoji symbol="üè†" label="Casa" />{' '}
                      {reg.copropietarios?.nombre || '-'}
                      <br />
                      <small>
                        {reg.copropietarios?.propiedad || ''} - {reg.copropietarios?.unidad_asignada || ''}
                      </small>
                    </td>
                    <td style={{ textAlign: 'center' }}>
                      {reg.usuario?.nombre || '-'}
                    </td>
                    <td style={{ textAlign: 'center' }}>
                      {reg.foto_url && (
                        <a href={reg.foto_url} target="_blank" rel="noopener noreferrer">
                          <img src={reg.foto_url} alt="Evidencia" className="thumbnail" />
                        </a>
                      )}
                    </td>
                    <td style={{ textAlign: 'center' }}>
                      {reg.observacion_audio_url && reg.observacion_audio_url !== 'pendiente-sync' ? (
                        <audio controls style={{ width: 90 }}>
                          <source src={reg.observacion_audio_url} type="audio/webm" />
                          Tu navegador no soporta audio.
                        </audio>
                      ) : (
                        <span style={{ color: '#aaa', fontSize: 14 }}>-</span>
                      )}
                    </td>
                    <td style={{ textAlign: 'center' }}>
                      <button
                        className="edit-btn"
                        title="Editar"
                        onClick={() => handleEdit(reg)}
                        style={{ marginRight: 6 }}
                        disabled={!isOnline || savingEdit}
                      >
                        <Emoji symbol="‚úèÔ∏è" label="Editar" />
                      </button>
                      <button
                        className="delete-btn"
                        title="Eliminar"
                        onClick={() => handleDelete(reg)}
                        disabled={!isOnline || deleting}
                      >
                        <Emoji symbol="üóëÔ∏è" label="Eliminar" />
                      </button>
                    </td>
                  </tr>
                ))}
                <tr style={{ fontWeight: 'bold', background: '#f6f8fc' }}>
                  <td colSpan={4} style={{ textAlign: 'right' }}>
                    Total
                  </td>
                  <td style={{ textAlign: 'center' }}>
                    ${totalMonto.toFixed(2)}
                  </td>
                  <td colSpan={9}></td>
                </tr>
              </>
            ) : (
              <tr>
                <td colSpan="13" className="sin-resultados">
                  No se encontraron registros con los filtros seleccionados
                </td>
              </tr>
            )}
          </tbody>
        </table>
      </div>

      {/* Modal de edici√≥n */}
      {editModal.open && (
        <div className="modal-backdrop">
          <div className="modal-content">
            <h3>Editar Registro</h3>
            <form className="modal-form" onSubmit={handleEditSave}>
              <label>
                Placa:
                <input
                  name="placa_vehiculo"
                  value={editData.placa_vehiculo}
                  onChange={handleEditChange}
                  required
                  disabled={!isOnline}
                />
              </label>
              <label>
                Tipo:
                <select
                  name="tipo_vehiculo"
                  value={editData.tipo_vehiculo}
                  onChange={handleEditChange}
                  required
                  disabled={!isOnline}
                >
                  <option value="carro">Carro</option>
                  <option value="moto">Moto</option>
                </select>
              </label>
              <label>
                Fecha ingreso:
                <input
                  type="date"
                  name="fecha_hora_ingreso"
                  value={editData.fecha_hora_ingreso}
                  onChange={handleEditChange}
                  required
                  disabled={!isOnline}
                />
              </label>
              <label>
                Observaciones:
                <input
                  name="observaciones"
                  value={editData.observaciones}
                  onChange={handleEditChange}
                  disabled={!isOnline}
                />
              </label>
              <label>
                Copropietario:
                <select
                  name="dependencia_id"
                  value={editData.dependencia_id || ''}
                  onChange={handleEditChange}
                  required
                  disabled={!isOnline}
                >
                  <option value="">Seleccione...</option>
                  {copropietarios.map(dep => (
                    <option key={dep.id} value={dep.id}>
                      {dep.nombre} ({dep.propiedad} - {dep.unidad_asignada})
                    </option>
                  ))}
                </select>
              </label>
              <label className="checkbox-label">
                <input
                  type="checkbox"
                  name="gratis"
                  checked={!!editData.gratis}
                  onChange={handleEditChange}
                  disabled={!isOnline}
                />
                <Emoji symbol="üÜì" label="Gratis" /> Gratis
              </label>
              <label className="checkbox-label">
                <input
                  type="checkbox"
                  name="recaudado"
                  checked={!!editData.recaudado}
                  onChange={handleEditChange}
                  disabled={!isOnline}
                />
                <Emoji symbol="üîó" label="Recaudado" /> Recaudado
              </label>
              {editData.recaudado && (
                <label>
                  Fecha Recaudo:
                  <input
                    type="date"
                    name="fecha_recaudo"
                    value={editData.fecha_recaudo || ''}
                    onChange={handleEditChange}
                    required={!!editData.recaudado}
                    disabled={!isOnline || !editData.recaudado}
                  />
                </label>
              )}
              <label>
                Evidencia auditiva:
                {editData.observacion_audio_url && editData.observacion_audio_url !== 'pendiente-sync' ? (
                  <>
                    <audio controls style={{ width: '100%', margin: '8px 0' }}>
                      <source src={editData.observacion_audio_url} type="audio/webm" />
                      Tu navegador no soporta audio.
                    </audio>
                    <button
                      type="button"
                      onClick={handleEliminarAudio}
                      className="delete-btn"
                      style={{ marginTop: 8 }}
                      disabled={eliminandoAudio || !isOnline}
                    >
                      {eliminandoAudio ? 'Eliminando...' : <><Emoji symbol="üóëÔ∏è" /> Eliminar audio</>}
                    </button>
                  </>
                ) : (
                  <span style={{ color: '#aaa', fontSize: 14 }}>No hay audio guardado.</span>
                )}
                <input
                  type="file"
                  accept="audio/*"
                  onChange={e => setEditData(prev => ({
                    ...prev,
                    nuevoAudio: e.target.files && e.target.files[0] ? e.target.files[0] : null
                  }))}
                  disabled={!isOnline}
                  style={{ marginTop: 8 }}
                />
                <span style={{ fontSize: 12, color: '#888' }}>
                  Puedes subir un nuevo archivo de audio para reemplazar el actual.
                </span>
              </label>
              <div style={{ marginTop: 18 }}>
                <button
                  type="submit"
                  className="save-btn"
                  disabled={!isOnline || savingEdit}
                >
                  Guardar
                </button>
                <button
                  type="button"
                  className="cancel-btn"
                  onClick={() => setEditModal({ open: false, registro: null })}
                  disabled={savingEdit}
                >
                  Cancelar
                </button>
              </div>
            </form>
          </div>
        </div>
      )}
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\Loader.jsx -----

// src/components/Loader.jsx
import React from 'react'

export default function Loader({ fullScreen = false, text = "‚è≥ Cargando..." }) {
  const loaderStyle = {
    display: 'flex',
    flexDirection: 'column',
    alignItems: 'center',
    justifyContent: 'center',
    minHeight: fullScreen ? '100vh' : '120px',
    width: '100%',
    background: fullScreen ? '#f5f6fa' : 'transparent',
    position: fullScreen ? 'fixed' : 'static',
    top: 0,
    left: 0,
    zIndex: 9999,
  }

  const spinnerStyle = {
    width: '48px',
    height: '48px',
    border: '6px solid #e0e0e0',
    borderTop: '6px solid #3498db',
    borderRadius: '50%',
    animation: 'spin 1s linear infinite',
    marginBottom: '1rem',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    fontSize: '2rem'
  }

  return (
    <div style={loaderStyle}>
      <div style={spinnerStyle}>
        <span role="img" aria-label="reloj de arena" style={{ position: 'absolute', fontSize: '2.2rem', marginTop: 2 }}>
          ‚è≥
        </span>
      </div>
      <span style={{ color: '#2c3e50', fontWeight: 'bold', fontSize: '1.1rem' }}>{text}</span>
      <style>
        {`
          @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
          }
        `}
      </style>
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\LoadingOverlay.jsx -----

// src/components/LoadingOverlay.jsx
import React from 'react'

/**
 * LoadingOverlay
 * @param {string} message - Mensaje opcional para mostrar debajo del spinner
 * @param {boolean} fullScreen - Si es true, ocupa toda la pantalla
 */
export default function LoadingOverlay({ message = 'Cargando...', fullScreen = true }) {
  return (
    <div
      className={`flex flex-col items-center justify-center ${
        fullScreen
          ? 'fixed inset-0 z-50 bg-white/80 dark:bg-gray-900/80'
          : 'w-full h-full'
      }`}
      style={fullScreen ? { minHeight: '100vh' } : {}}
      aria-busy="true"
      aria-live="polite"
      role="status"
    >
      <div className="mb-4">
        {/* Spinner SVG accesible */}
        <svg
          className="animate-spin h-12 w-12 text-blue-600 dark:text-blue-400"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <circle
            className="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            strokeWidth="4"
          />
          <path
            className="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
          />
        </svg>
      </div>
      <span className="text-gray-700 dark:text-gray-200 text-lg font-medium">{message}</span>
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\LoadingScreen.jsx -----

// src/components/LoadingScreen.jsx

import React from 'react';

export default function LoadingScreen({ message = 'Cargando...', fullScreen = false }) {
  return (
    <div
      className={`flex flex-col items-center justify-center ${
        fullScreen
          ? 'fixed inset-0 z-50 bg-white dark:bg-gray-900 bg-opacity-80'
          : 'w-full h-full'
      }`}
      aria-busy="true"
      aria-live="polite"
      role="status"
    >
      <div className="mb-4">
        {/* Spinner SVG accesible */}
        <svg
          className="animate-spin h-10 w-10 text-blue-600 dark:text-blue-400"
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <circle
            className="opacity-25"
            cx="12"
            cy="12"
            r="10"
            stroke="currentColor"
            strokeWidth="4"
          />
          <path
            className="opacity-75"
            fill="currentColor"
            d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"
          />
        </svg>
      </div>
      <span className="text-gray-600 dark:text-gray-200 text-lg font-medium">{message}</span>
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\Modal.jsx -----

// src/components/Modal.jsx
import React, { useEffect } from "react";

/**
 * Modal reutilizable para toda la app.
 * Props:
 * - isOpen: boolean, controla si el modal est√° abierto
 * - onClose: funci√≥n, llamada al cerrar (clic fondo o bot√≥n cerrar)
 * - children: contenido del modal
 */
const Modal = ({ isOpen, onClose, children }) => {
  if (!isOpen) return null;

  // Evita el scroll del fondo cuando el modal est√° abierto
  useEffect(() => {
    const originalOverflow = document.body.style.overflow;
    document.body.style.overflow = "hidden";
    return () => { document.body.style.overflow = originalOverflow; };
  }, []);

  return (
    <div
      className="modal-backdrop"
      style={{
        position: "fixed",
        top: 0, left: 0,
        width: "100vw",
        height: "100vh",
        background: "rgba(24,24,27,0.7)",
        zIndex: 9999,
        display: "flex",
        alignItems: "center",
        justifyContent: "center"
      }}
      onClick={onClose}
      aria-modal="true"
      role="dialog"
    >
      <div
        className="modal-content"
        style={{
          background: "var(--surface, #fff)",
          borderRadius: 20,
          boxShadow: "0 8px 32px #6366f133",
          padding: "2rem",
          maxWidth: 480,
          width: "90vw",
          maxHeight: "90vh",
          overflowY: "auto",
          textAlign: "left",
          position: "relative"
        }}
        onClick={e => e.stopPropagation()}
      >
        {/* Bot√≥n de cerrar en la esquina superior derecha */}
        <button
          onClick={onClose}
          className="absolute top-2 right-2 text-gray-400 hover:text-red-500 text-2xl font-bold focus:outline-none"
          aria-label="Cerrar modal"
          type="button"
          style={{
            position: "absolute",
            top: 12,
            right: 12,
            background: "transparent",
            border: "none",
            fontSize: 28,
            color: "#888",
            cursor: "pointer"
          }}
        >
          √ó
        </button>
        {children}
      </div>
    </div>
  );
};

export default Modal;


----- C:\ThomasParking\ThomasParking\src\components\Navbar.jsx -----

// src/components/Navbar.jsx
import React from 'react';
import { NavLink, useNavigate } from 'react-router-dom';
import supabase from '../supabaseClient';
import Emoji from './Emoji';
import ThemeToggle from './ThemeToggle';

function NavMenuMobile({ navItems, user, handleNavClick, handleLogout }) {
  const rol = user?.user_metadata?.role || user?.role || 'Rol no disponible';
  const esAdmin = rol.toLowerCase() === 'admin';

  return (
    <nav
      className="fixed inset-0 z-50 bg-gradient-to-br from-blue-700 to-purple-700 flex flex-col items-center justify-center space-y-4"
      role="navigation"
      aria-label="Men√∫ principal m√≥vil"
    >
      {navItems.map(item => (
        <NavLink
          key={item.to}
          to={item.to}
          onClick={handleNavClick}
          className={({ isActive }) =>
            `flex items-center gap-2 px-6 py-4 rounded-lg font-medium text-2xl transition-colors focus:outline-none ${
              isActive ? 'bg-white text-blue-700' : 'text-white hover:bg-white/20'
            }`
          }
          aria-current={({ isActive }) => (isActive ? 'page' : undefined)}
        >
          <Emoji symbol={item.emoji} label={item.label} /> {item.label}
        </NavLink>
      ))}
      {user && (
        <div className="flex flex-col items-center mt-6 text-center">
          <span className="text-white font-semibold text-base">{user.email}</span>
          <span className="text-white text-xs font-normal mt-1 flex items-center justify-center gap-1">
            <Emoji symbol="üîë" label="Rol" /> {rol.toUpperCase()}
            {esAdmin && <Emoji symbol="üëë" label="Administrador" />}
          </span>
        </div>
      )}
      <div className="mt-6">
        <ThemeToggle />
      </div>
      <button
        onClick={handleLogout}
        className="flex items-center mt-4 px-5 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium text-lg transition-colors"
        aria-label="Cerrar sesi√≥n"
      >
        <Emoji symbol="üö™" label="Cerrar sesi√≥n" /> <span className="ml-2">Cerrar Sesi√≥n</span>
      </button>
    </nav>
  );
}

export default function Navbar({ user, menuOpen, setMenuOpen }) {
  const navigate = useNavigate();

  const handleLogout = async () => {
    await supabase.auth.signOut();
    setMenuOpen(false);
    navigate('/login');
  };

  const navItems = [
    { to: '/registros', label: 'Registro Parqueo', emoji: 'üìù' },
    { to: '/consultas', label: 'Reportes', emoji: 'üìä' },
    { to: '/recaudo', label: 'Recaudaci√≥n', emoji: 'üí∞' },
    { to: '/descargos', label: 'Descargos', emoji: 'üì§' },
    { to: '/copropietarios', label: 'Copropietarios', emoji: 'üèòÔ∏è' },
    { to: '/usuarios', label: 'Usuarios', emoji: 'üë•' },
    { to: '/acercade', label: 'Acerca de', emoji: '‚ÑπÔ∏è' },
  ];

  const handleNavClick = () => setMenuOpen(false);

  const rol = user?.user_metadata?.role || user?.role || 'Rol no disponible';
  const esAdmin = rol.toLowerCase() === 'admin';

  return (
    <header className="w-full bg-gradient-to-r from-blue-700 to-purple-700 shadow-md fixed top-0 left-0 z-50">
      <div className="max-w-7xl mx-auto flex items-center px-4 h-16">
        {/* Logo y t√≠tulo */}
        <div className="flex-shrink-0 flex items-center">
          <NavLink
            to="/"
            className="flex items-center space-x-2 text-white font-bold text-lg"
            onClick={handleNavClick}
            aria-label="Inicio"
          >
            <Emoji symbol="üÖøÔ∏è" label="Parking" /> <span>ParkingApp</span>
          </NavLink>
        </div>

        {/* Usuario logueado: email y rol (escritorio) */}
        {user && (
          <div className="hidden md:flex flex-col items-end ml-auto mr-4 text-white text-right">
            <span className="font-semibold">{user.email}</span>
            <span className="text-sm font-normal text-blue-200 flex items-center gap-1 justify-end">
              <Emoji symbol="üîë" label="Rol" /> {rol.toUpperCase()}
              {esAdmin && <Emoji symbol="üëë" label="Administrador" />}
            </span>
          </div>
        )}

        {/* Selector de tema (escritorio) */}
        <div className="hidden md:flex items-center">
          <ThemeToggle />
        </div>

        {/* Bot√≥n hamburguesa */}
        <button
          className="flex items-center justify-center text-white focus:outline-none ml-2 p-1"
          aria-label={menuOpen ? "Cerrar men√∫" : "Abrir men√∫"}
          aria-expanded={menuOpen}
          onClick={() => setMenuOpen(!menuOpen)}
          type="button"
          style={{ minWidth: 0, minHeight: 0, width: '32px', height: '32px', padding: '4px' }}
        >
          <svg className="w-5 h-5" fill="none" stroke="currentColor" strokeWidth={2} viewBox="0 0 24 24">
            <path strokeLinecap="round" strokeLinejoin="round"
              d={menuOpen ? "M6 18L18 6M6 6l12 12" : "M4 6h16M4 12h16M4 18h16"} />
          </svg>
        </button>
      </div>

      {/* Men√∫ m√≥vil */}
      {menuOpen && (
        <NavMenuMobile
          navItems={navItems}
          user={user}
          handleNavClick={handleNavClick}
          handleLogout={handleLogout}
        />
      )}
    </header>
  );
}


----- C:\ThomasParking\ThomasParking\src\components\ResizeImage.jsx -----

import React, { useState, useEffect, useRef } from 'react';
import CapturaCamara from './CapturaCamara';

export default function ResizeImage({ 
  onFilesSelected, 
  maxFiles = 5, 
  disabled = false,
  maxWidth = 800,
  quality = 0.8
}) {
  const [previews, setPreviews] = useState([]);
  const [files, setFiles] = useState([]);
  const [modo, setModo] = useState('galeria');
  const fileInputRef = useRef(null);

  const resizeImage = (file) => {
    return new Promise((resolve) => {
      const img = new Image();
      const url = URL.createObjectURL(file);
      
      img.onload = () => {
        const canvas = document.createElement('canvas');
        let width = img.width;
        let height = img.height;

        if (width > maxWidth) {
          const scale = maxWidth / width;
          width = maxWidth;
          height = height * scale;
        }

        canvas.width = width;
        canvas.height = height;
        const ctx = canvas.getContext('2d');
        ctx.drawImage(img, 0, 0, width, height);
        
        canvas.toBlob(
          (blob) => {
            const resizedFile = new File([blob], file.name, {
              type: 'image/jpeg',
              lastModified: Date.now()
            });
            URL.revokeObjectURL(url);
            resolve(resizedFile);
          },
          'image/jpeg',
          quality
        );
      };
      
      img.src = url;
    });
  };

  const handleFiles = async (newFiles) => {
    if (disabled) return;
    
    const processedFiles = await Promise.all(
      Array.from(newFiles)
        .slice(0, maxFiles - files.length)
        .map(async (file) => {
          if (file.type.startsWith('image/')) {
            return await resizeImage(file);
          }
          return file;
        })
    );

    const updatedFiles = [...files, ...processedFiles].slice(0, maxFiles);
    setFiles(updatedFiles);
    onFilesSelected(updatedFiles);
  };

  const handleFileInput = (e) => {
    handleFiles(e.target.files);
    e.target.value = null;
  };

  const handleCameraCapture = async (file) => {
    const resizedFile = await resizeImage(file);
    handleFiles([resizedFile]);
  };

  const removeFile = (index) => {
    const newFiles = files.filter((_, i) => i !== index);
    setFiles(newFiles);
    onFilesSelected(newFiles);
  };

  useEffect(() => {
    const newPreviews = files.map(file => ({
      url: URL.createObjectURL(file),
      name: file.name,
      type: file.type,
    }));
    
    setPreviews(newPreviews);

    return () => {
      newPreviews.forEach(p => URL.revokeObjectURL(p.url));
    };
  }, [files]);

  return (
    <div className="space-y-4">
      <div className="flex gap-4 mb-4">
        <button
          type="button"
          onClick={() => setModo('galeria')}
          className={`px-4 py-2 rounded-lg ${
            modo === 'galeria' 
            ? 'bg-blue-600 text-white' 
            : 'bg-gray-100 hover:bg-gray-200'
          }`}
          disabled={disabled}
        >
          üñºÔ∏è Subir Archivos
        </button>
        
        <button
          type="button"
          onClick={() => setModo('camara')}
          className={`px-4 py-2 rounded-lg ${
            modo === 'camara' 
            ? 'bg-blue-600 text-white' 
            : 'bg-gray-100 hover:bg-gray-200'
          }`}
          disabled={disabled || files.length >= maxFiles}
        >
          üì∏ Usar C√°mara
        </button>
      </div>

      {modo === 'galeria' ? (
        <>
          <input
            ref={fileInputRef}
            type="file"
            accept="image/*"
            multiple
            onChange={handleFileInput}
            className="hidden"
            disabled={disabled || files.length >= maxFiles}
          />
          
          <button
            type="button"
            onClick={() => fileInputRef.current.click()}
            className="w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 transition-colors"
            disabled={disabled || files.length >= maxFiles}
          >
            <div className="text-center text-gray-500">
              Arrastra archivos o haz clic para seleccionar
              <div className="text-sm mt-2">
                M√°ximo {maxFiles} im√°genes ({maxWidth}px ancho m√°ximo)
              </div>
              <div className="text-sm">
                Formatos soportados: JPEG, PNG
              </div>
            </div>
          </button>
        </>
      ) : (
        <div className="border rounded-lg p-4">
          <CapturaCamara 
            onCaptura={handleCameraCapture}
            maxWidth={maxWidth}
            disabled={disabled || files.length >= maxFiles}
          />
        </div>
      )}

      {previews.length > 0 && (
        <div className="mt-4">
          <div className="flex flex-wrap gap-4">
            {previews.map((preview, index) => (
              <div key={index} className="relative group">
                <div className="absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg flex items-center justify-center">
                  <button
  type="button"
  onClick={() => removeFile(index)}
  className="p-2 bg-red-500 rounded-full hover:bg-red-600 transition-colors"
  aria-label="Eliminar imagen"
  style={{
    fontSize: 18,
    fontWeight: 'bold',
    lineHeight: 1,
    width: 24,
    height: 24,
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    padding: 0
  }}
>
  √ó
</button>

                </div>
                
                <img
  src={preview.url}
  alt={preview.name}
  style={{
    width: 38,
    height: 38,
    objectFit: 'cover',
    borderRadius: 6,
    border: '1px solid #ccc'
  }}
/>

                
                <div className="text-xs mt-1 text-gray-600 truncate">
                  {preview.name}
                </div>
              </div>
            ))}
          </div>
          
          <div className="mt-2 text-sm text-gray-500">
            {files.length}/{maxFiles} archivos seleccionados
          </div>
        </div>
      )}
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\components\ResumenRegistros.jsx -----

// src/components/ResumenRegistros.jsx
import React from 'react'
import Emoji from './Emoji'

export default function ResumenRegistros({ registros = [] }) {
  const resumen = registros.reduce((acc, reg) => {
    if (reg.gratis) acc.gratis++
    else if (reg.recaudado) acc.recaudado += Number(reg.monto)
    else acc.pendiente += Number(reg.monto)
    acc.total += Number(reg.monto)
    acc.cantidad++
    return acc
  }, { recaudado: 0, pendiente: 0, gratis: 0, total: 0, cantidad: 0 })

  return (
    <div style={{
      display: 'grid',
      gridTemplateColumns: 'repeat(auto-fit, minmax(160px, 1fr))',
      gap: '1rem',
      padding: '1rem',
      background: 'rgba(255, 255, 255, 0.1)',
      borderRadius: '12px',
      boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)'
    }}>
      <div style={{ textAlign: 'center' }}>
        <div style={{ fontSize: '1.5rem' }}>
          <Emoji symbol="üí∞" /> ${resumen.recaudado.toFixed(2)}
        </div>
        <small style={{ color: '#666' }}>Recaudado</small>
      </div>

      <div style={{ textAlign: 'center' }}>
        <div style={{ fontSize: '1.5rem' }}>
          <Emoji symbol="‚è≥" /> ${resumen.pendiente.toFixed(2)}
        </div>
        <small style={{ color: '#666' }}>Pendiente</small>
      </div>

      <div style={{ textAlign: 'center' }}>
        <div style={{ fontSize: '1.5rem' }}>
          <Emoji symbol="üÜì" /> {resumen.gratis}
        </div>
        <small style={{ color: '#666' }}>Gratis</small>
      </div>

      <div style={{ textAlign: 'center' }}>
        <div style={{ fontSize: '1.5rem' }}>
          <Emoji symbol="üìã" /> {resumen.cantidad}
        </div>
        <small style={{ color: '#666' }}>Registros</small>
      </div>

      <div style={{ textAlign: 'center' }}>
        <div style={{ fontSize: '1.5rem' }}>
          <Emoji symbol="üßæ" /> ${resumen.total.toFixed(2)}
        </div>
        <small style={{ color: '#666' }}>Total</small>
      </div>
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\components\SelectorDeFoto.jsx -----

import React, { useState, useEffect } from 'react';
import CapturaCamara from './CapturaCamara';

export default function SelectorDeFoto({ onFilesSelected, maxFiles = 5, disabled }) {
  const [previews, setPreviews] = useState([]);
  const [files, setFiles] = useState([]);
  const [modo, setModo] = useState('galeria');

  const actualizarArchivos = (nuevosArchivos) => {
    const archivosCombinados = [...files, ...nuevosArchivos].slice(0, maxFiles);
    setFiles(archivosCombinados);
    if(onFilesSelected) onFilesSelected(archivosCombinados);
  };

  const handleFileChange = (e) => {
    if(disabled) return;
    const selectedFiles = Array.from(e.target.files);
    actualizarArchivos(selectedFiles);
  };

  const handleCapturaCamara = (file) => {
    if(disabled) return;
    actualizarArchivos([file]);
  };

  const eliminarFoto = (index) => {
    const nuevosArchivos = files.filter((_, i) => i !== index);
    setFiles(nuevosArchivos);
    if(onFilesSelected) onFilesSelected(nuevosArchivos);
  };

  useEffect(() => {
    const nuevasPreviews = files.map(file => ({
      url: URL.createObjectURL(file),
      name: file.name,
      type: file.type,
    }));
    
    setPreviews(nuevasPreviews);

    return () => {
      nuevasPreviews.forEach(p => URL.revokeObjectURL(p.url));
    };
  }, [files]);

  return (
    <div className="selector-foto">
      <div className="modos-seleccion" style={{ marginBottom: '1rem' }}>
        <button
          type="button"
          onClick={() => setModo('galeria')}
          className={modo === 'galeria' ? 'active' : ''}
          style={{ marginRight: '1rem' }}
          disabled={disabled}
        >
          üñºÔ∏è Subir Archivos
        </button>
        <button
          type="button"
          onClick={() => setModo('camara')}
          className={modo === 'camara' ? 'active' : ''}
          disabled={disabled}
        >
          üì∏ Usar C√°mara
        </button>
      </div>

      {modo === 'galeria' ? (
        <>
          <input
            type="file"
            accept="image/*"
            multiple
            onChange={handleFileChange}
            aria-label="Seleccionar fotos"
            style={{ display: 'block', margin: '1rem 0' }}
            disabled={disabled || files.length >= maxFiles}
          />
          <div style={{ display: 'flex', gap: 10, flexWrap: 'wrap' }}>
            {previews.map((preview, idx) => (
              <div key={idx} style={{ textAlign: 'center', position: 'relative' }}>
                <button
                  onClick={() => eliminarFoto(idx)}
                  style={{
                    position: 'absolute',
                    top: -8,
                    right: -8,
                    background: '#dc2626',
                    color: 'white',
                    border: 'none',
                    borderRadius: '50%',
                    width: 20,
                    height: 20,
                    cursor: 'pointer',
                  }}
                  aria-label="Eliminar foto"
                >
                  √ó
                </button>
                <img
                  src={preview.url}
                  alt={preview.name}
                  style={{
                    width: 90,
                    height: 90,
                    objectFit: 'cover',
                    borderRadius: 6,
                    border: '1px solid #ccc',
                  }}
                />
                <div style={{ fontSize: 11, marginTop: 4 }}>
                  {preview.name.length > 15 
                    ? preview.name.slice(0, 12) + '...' 
                    : preview.name}
                </div>
              </div>
            ))}
          </div>
          <small style={{ display: 'block', marginTop: '0.5rem', color: '#666' }}>
            {files.length}/{maxFiles} fotos seleccionadas
          </small>
        </>
      ) : (
        <div style={{ border: '1px solid #ddd', borderRadius: '8px', padding: '1rem' }}>
          <CapturaCamara 
            onCaptura={handleCapturaCamara}
            onCancelar={() => setModo('galeria')}
            maxWidth="220px"
          />
        </div>
      )}
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\components\SignUp.jsx -----

import React from 'react';
import { useState } from 'react';
import supabase from '../supabaseClient';
import { Link } from 'react-router-dom';
import Loader from './Loader';
import Emoji from './Emoji';

export default function SignUp() {
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');
  const [nombre, setNombre] = useState('');
  const [rol, setRol] = useState('registrador');
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleSignUp = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      // Validaciones del cliente
      if (!nombre.trim()) throw new Error('El nombre es obligatorio');
      if (!/\S+@\S+\.\S+/.test(email)) throw new Error('Formato de correo inv√°lido');
      if (password.length < 6) throw new Error('La contrase√±a debe tener al menos 6 caracteres');

      const { data, error: authError } = await supabase.auth.signUp({
        email,
        password,
        options: {
          data: {
            nombre: nombre.trim(),
            rol: rol === 'copropietario' ? 'copropietario' : rol
          },
          emailRedirectTo: `${window.location.origin}/login`
        },
      });

      if (authError) {
        if (authError.message.includes('already registered')) {
          throw new Error('Este correo ya est√° registrado');
        }
        throw authError;
      }

      alert('Registro exitoso! Verifica tu correo electr√≥nico para activar la cuenta.');
      setTimeout(() => window.location.href = '/login', 2000);

    } catch (error) {
      setError(error.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="max-w-md mx-auto p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md">
      <h2 className="text-2xl font-bold mb-6 text-center dark:text-white">
        <Emoji symbol="üìù" /> Registro de Usuario
      </h2>

      {error && (
        <div className="mb-4 p-3 bg-red-100 text-red-700 rounded-md">
          ‚ö†Ô∏è {error}
        </div>
      )}

      <form onSubmit={handleSignUp} className="space-y-4">
        <div>
          <label className="block text-sm font-medium mb-1 dark:text-gray-200">
            Nombre Completo
          </label>
          <input
            type="text"
            value={nombre}
            onChange={(e) => setNombre(e.target.value)}
            className="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            placeholder="Ej: Juan P√©rez"
            required
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-1 dark:text-gray-200">
            Correo Electr√≥nico
          </label>
          <input
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            className="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            placeholder="tucorreo@ejemplo.com"
            required
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-1 dark:text-gray-200">
            Contrase√±a
          </label>
          <input
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            className="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white"
            placeholder="M√≠nimo 6 caracteres"
            required
          />
        </div>

        <div>
          <label className="block text-sm font-medium mb-1 dark:text-gray-200">
            Rol del Usuario
          </label>
          <select
            value={rol}
            onChange={(e) => setRol(e.target.value)}
            className="w-full p-2 border rounded-md dark:bg-gray-700 dark:border-gray-600 dark:text-white"
          >
            <option value="registrador">Registrador</option>
            <option value="admin">Administrador</option>
            <option value="copropietario">Copropietario</option>
          </select>
        </div>

        <button
          type="submit"
          disabled={loading}
          className="w-full bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 transition-colors flex items-center justify-center"
        >
          {loading ? (
            <Loader text="Registrando..." small />
          ) : (
            <>
              <Emoji symbol="üìù" /> Registrarse
            </>
          )}
        </button>
      </form>

      <p className="mt-4 text-center text-sm dark:text-gray-300">
        ¬øYa tienes cuenta?{' '}
        <Link
          to="/login"
          className="text-blue-600 hover:underline dark:text-blue-400"
        >
          Inicia sesi√≥n aqu√≠
        </Link>
      </p>
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\components\SyncIndicator.jsx -----

import React from 'react';

export default function SyncIndicator({ syncStatus }) {
  // syncStatus puede ser: 'idle', 'syncing', 'success', 'error'
  let message = null;
  let style = {
    padding: '6px 12px',
    borderRadius: 8,
    fontWeight: '600',
    fontSize: '0.9rem',
    display: 'inline-flex',
    alignItems: 'center',
    gap: 6,
  };

  switch (syncStatus) {
    case 'syncing':
      message = <>üîÑ Sincronizando datos...</>;
      style = { ...style, backgroundColor: '#e0f2fe', color: '#0284c7' };
      break;
    case 'success':
      message = <>‚úÖ Sincronizaci√≥n exitosa</>;
      style = { ...style, backgroundColor: '#dcfce7', color: '#15803d' };
      break;
    case 'error':
      message = <>‚ùå Error en la sincronizaci√≥n</>;
      style = { ...style, backgroundColor: '#fee2e2', color: '#b91c1c' };
      break;
    default:
      return null; // no mostrar nada si idle
  }

  return <div style={style} aria-live="polite">{message}</div>;
}


----- C:\ThomasParking\ThomasParking\src\components\TablaResultados.jsx -----

import React from 'react';
import PropTypes from 'prop-types';

const TablaResultados = ({ resultados, onSeleccion }) => (
  <table className="tabla-resultados">
    <thead>
      <tr>
        <th>ID</th>
        <th>Nombre</th>
        <th>Estado</th>
      </tr>
    </thead>
    <tbody>
      {resultados.length === 0 ? (
        <tr>
          <td colSpan={3} style={{ textAlign: 'center' }}>No hay resultados</td>
        </tr>
      ) : (
        resultados.map(item => (
          <tr
            key={item.id}
            onClick={() => onSeleccion(item)}
            className="fila-seleccionable"
            style={{ cursor: 'pointer' }}
          >
            <td>{item.id}</td>
            <td>{item.nombre}</td>
            <td>{item.estado}</td>
          </tr>
        ))
      )}
    </tbody>
  </table>
);

TablaResultados.propTypes = {
  resultados: PropTypes.array.isRequired,
  onSeleccion: PropTypes.func.isRequired,
};

export default TablaResultados;


----- C:\ThomasParking\ThomasParking\src\components\ThemeToggle.jsx -----

// src/components/ThemeToggle.jsx
import React from 'react';
import { useTheme } from '../context/ThemeContext';

export default function ThemeToggle() {
  const { appearance, setAppearance } = useTheme();

  return (
    <select
      value={appearance}
      onChange={e => setAppearance(e.target.value)}
      style={{ borderRadius: 8, padding: 6, marginLeft: 10, fontWeight: 600 }}
      aria-label="Selector de tema"
    >
      <option value="light">üåû Claro</option>
      <option value="dark">üåô Oscuro</option>
      <option value="system">üñ•Ô∏è Sistema</option>
    </select>
  );
}


----- C:\ThomasParking\ThomasParking\src\context\ThemeContext.jsx -----

// src/context/ThemeContext.jsx
import React, { createContext, useContext, useEffect, useState, useCallback } from 'react'

const ThemeContext = createContext()

const THEMES = ['light', 'dark', 'system']

function getPreferredTheme() {
  if (typeof window === 'undefined') return 'light'
  return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light'
}

function applyTheme(appearance) {
  const isDark =
    appearance === 'dark' ||
    (appearance === 'system' && getPreferredTheme() === 'dark')
  document.documentElement.classList.toggle('dark', isDark)
}

export function ThemeProvider({ children }) {
  const [appearance, setAppearance] = useState(() => {
    if (typeof window === 'undefined') return 'system'
    return localStorage.getItem('appearance') || 'system'
  })

  // Actualiza el tema cuando cambia la preferencia
  const updateAppearance = useCallback(
    (mode) => {
      if (!THEMES.includes(mode)) mode = 'system'
      setAppearance(mode)
      localStorage.setItem('appearance', mode)
      applyTheme(mode)
    },
    []
  )

  // Inicializa y escucha cambios del sistema
  useEffect(() => {
    applyTheme(appearance)
    const mq = window.matchMedia('(prefers-color-scheme: dark)')
    const handleChange = () => {
      if (appearance === 'system') applyTheme('system')
    }
    mq.addEventListener('change', handleChange)
    return () => mq.removeEventListener('change', handleChange)
  }, [appearance])

  return (
    <ThemeContext.Provider value={{ appearance, setAppearance: updateAppearance }}>
      {children}
    </ThemeContext.Provider>
  )
}

export function useTheme() {
  const context = useContext(ThemeContext)
  if (!context) throw new Error('useTheme debe usarse dentro de ThemeProvider')
  return context
}


----- C:\ThomasParking\ThomasParking\src\context\ViewContext.jsx -----

// src/context/ViewContext.jsx
import React, { createContext, useContext, useState } from 'react'

const ViewContext = createContext()

export function ViewProvider({ children }) {
  const [currentView, setCurrentView] = useState('registro') // Estado inicial
  
  return (
    <ViewContext.Provider value={{ currentView, setCurrentView }}>
      {children}
    </ViewContext.Provider>
  )
}

export const useView = () => {
  const context = useContext(ViewContext)
  if (!context) {
    throw new Error('useView debe usarse dentro de un ViewProvider')
  }
  return context
}


----- C:\ThomasParking\ThomasParking\src\hooks\useHover.jsx -----

import { useRef, useState, useEffect } from 'react';
import React from 'react'

export default function useHover() {
  const ref = useRef(null);
  const [isHovered, setIsHovered] = useState(false);

  useEffect(() => {
    const node = ref.current;
    if (!node) return;

    const handleMouseEnter = () => setIsHovered(true);
    const handleMouseLeave = () => setIsHovered(false);

    node.addEventListener('mouseenter', handleMouseEnter);
    node.addEventListener('mouseleave', handleMouseLeave);

    return () => {
      node.removeEventListener('mouseenter', handleMouseEnter);
      node.removeEventListener('mouseleave', handleMouseLeave);
    };
  }, [ref]);

  return [ref, isHovered];
}


----- C:\ThomasParking\ThomasParking\src\hooks\useOnlineStatus.jsx -----

// src/hooks/useOnlineStatus.jsx
import { useState, useEffect } from 'react'

export default function useOnlineStatus() {
  const [isOnline, setIsOnline] = useState(navigator.onLine)
  useEffect(() => {
    const update = () => setIsOnline(navigator.onLine)
    window.addEventListener('online', update)
    window.addEventListener('offline', update)
    return () => {
      window.removeEventListener('online', update)
      window.removeEventListener('offline', update)
    }
  }, [])
  return isOnline
}


----- C:\ThomasParking\ThomasParking\src\pages\AcercaDe.jsx -----

// src/pages/AcercaDe.jsx
import Emoji from '../components/Emoji'
import React from 'react'

export default function AcercaDe() {
  return (
    <section
      className="acerca-de-container"
      style={{
        background: '#f8fafc',
        borderRadius: 16,
        boxShadow: '0 4px 6px rgba(0,0,0,0.05)',
        padding: '2rem',
        maxWidth: 700,
        margin: '2rem auto',
        textAlign: 'left'
      }}
    >
      <h2 style={{ fontWeight: 700, fontSize: '1.5rem', marginBottom: 12 }}>
        <Emoji symbol="‚ÑπÔ∏è" label="Acerca de" /> Acerca de la aplicaci√≥n
      </h2>
      <p style={{ fontSize: '1.08rem', marginBottom: 14 }}>
        <Emoji symbol="üöó" label="Parqueadero" /> <b>ThomasParking</b> es una aplicaci√≥n web para la <b>gesti√≥n eficiente, transparente y segura de parqueaderos de visita</b> en el <b>Conjunto Habitacional Thomas II</b>.
      </p>
      <ul style={{ marginBottom: 18, paddingLeft: 22 }}>
        <li>
          <Emoji symbol="üìù" label="Registro" /> <b>Registrar ingresos y salidas:</b> Guarda cada ingreso y salida de veh√≠culos, asociando el registro a un copropietario y usuario responsable.
        </li>
        <li>
          <Emoji symbol="üîé" label="Consulta" /> <b>Consultas y filtros avanzados:</b> Busca y filtra registros por fecha, placa, propiedad, unidad, tipo de veh√≠culo y estado de pago.
        </li>
        <li>
          <Emoji symbol="üì∑" label="Foto" /> <b>Evidencia fotogr√°fica y auditiva:</b> Adjunta fotos y audios como evidencia en cada registro.
        </li>
        <li>
          <Emoji symbol="üë•" label="Usuarios" /> <b>Gesti√≥n de copropietarios y usuarios:</b> Administra residentes y personal, con control de roles y permisos.
        </li>
        <li>
          <Emoji symbol="üí∞" label="Recaudo" /> <b>Recaudaci√≥n y reportes:</b> Visualiza res√∫menes de montos recaudados, pendientes y registros gratuitos.
        </li>
        <li>
          <Emoji symbol="üì±" label="Offline" /> <b>Soporte offline:</b> Consulta y registra datos aunque pierdas conexi√≥n; la app sincroniza autom√°ticamente al volver en l√≠nea.
        </li>
        <li>
          <Emoji symbol="üîí" label="Seguridad" /> <b>Seguridad y privacidad:</b> Tus datos est√°n protegidos, con acceso restringido seg√∫n el rol y pol√≠ticas de seguridad avanzadas.
        </li>
      </ul>
      <p style={{ fontSize: '1.08rem', marginBottom: 14 }}>
        <Emoji symbol="üñ•Ô∏è" label="Tecnolog√≠a" /> <b>Interfaz moderna y responsiva</b>, accesible desde cualquier dispositivo.
      </p>
      <p style={{ fontSize: '1.08rem', marginBottom: 14 }}>
        <Emoji symbol="üë®‚Äçüíª" label="Desarrollador" /> <b>Desarrollado por:</b> Gabriel Ortega ‚Äì Presidente CEO Thomas II
      </p>
      <p style={{ fontSize: '1.08rem', marginBottom: 14 }}>
        <Emoji symbol="‚úâÔ∏è" label="Email" /> <b>Contacto:</b> <a href="mailto:gabrielortega@outlook.com">gabrielortega@outlook.com</a><br />
        <Emoji symbol="üì±" label="Celular" /> <b>Celular:</b> <a href="tel:0999268450">0999268450</a>
      </p>
      <p style={{ fontSize: '1.08rem', color: '#666', marginTop: 18 }}>
        <Emoji symbol="ü§ù" label="Comunidad" /> Esta aplicaci√≥n es el resultado del compromiso del conjunto Thomas II con la innovaci√≥n, la transparencia y la seguridad de todos sus residentes y visitantes.
      </p>
    </section>
  )
}


----- C:\ThomasParking\ThomasParking\src\pages\CapturaFoto.jsx -----

import React, { useState } from 'react';
import { useNavigate, useLocation } from 'react-router-dom';
import CapturaCamara from '../components/CapturaCamara';

export default function CapturaFoto() {
  const [foto, setFoto] = useState(null);
  const navigate = useNavigate();
  const location = useLocation();

  // Recibe la funci√≥n para manejar el archivo desde la p√°gina anterior, si se usa navigate con state
  const onEnviar = () => {
    if (location.state && location.state.onFileSelected && foto) {
      location.state.onFileSelected(foto);
    }
    navigate(-1); // Regresa a la p√°gina anterior
  };

  return (
    <div style={{
      minHeight: '100vh',
      background: '#000',
      display: 'flex',
      flexDirection: 'column',
      alignItems: 'center',
      justifyContent: 'center'
    }}>
      <div style={{ width: '100%', maxWidth: 320 }}>
        <CapturaCamara onCaptura={setFoto} />
      </div>
      {foto && (
        <button
          style={{
            marginTop: 20,
            padding: '12px 28px',
            fontSize: '1.1rem',
            background: '#38bdf8',
            color: '#fff',
            border: 'none',
            borderRadius: 8
          }}
          onClick={onEnviar}
        >
          Enviar foto
        </button>
      )}
      <button
        style={{
          marginTop: 16,
          background: 'transparent',
          color: '#fff',
          border: 'none',
          fontSize: 18
        }}
        onClick={() => navigate(-1)}
      >
        Cancelar
      </button>
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\pages\Consultas.jsx -----

// src/pages/Consultas.jsx
import React, { useState, useEffect } from 'react';
import supabase from '../supabaseClient';
import Loader from '../components/Loader';
import Emoji from '../components/Emoji';
import ErrorMessage from '../components/ErrorMessage';
import Modal from '../components/Modal';
import useOnlineStatus from '../hooks/useOnlineStatus';
import dayjs from 'dayjs';

export default function Consultas() {
  const [registros, setRegistros] = useState([]);
  const [copropietarios, setCopropietarios] = useState([]);
  const [resultados, setResultados] = useState([]);
  const [filtros, setFiltros] = useState({
    fechaInicio: '',
    fechaFin: '',
    placa: '',
    propiedad: '',
    unidadAsignada: '',
    tipoVehiculo: ''
  });
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [modal, setModal] = useState({ open: false, registro: null });
  const [form, setForm] = useState({});
  const [saving, setSaving] = useState(false);
  const [deleting, setDeleting] = useState(false);
  const isOnline = useOnlineStatus();

  // Cargar datos iniciales
  useEffect(() => {
    const cargarDatos = async () => {
      try {
        const [resRegistros, resCopropietarios] = await Promise.all([
          supabase
            .from('registros_parqueadero')
            .select(`
              id,
              placa_vehiculo,
              tipo_vehiculo,
              fecha_hora_ingreso,
              observaciones,
              foto_url,
              gratis,
              monto,
              recaudado,
              fecha_recaudo,
              dependencia_id,
              observacion_audio_url,
              copropietarios:dependencia_id(nombre, propiedad, unidad_asignada),
              usuarios_app:usuario_id(nombre, rol)
            `)
            .order('fecha_hora_ingreso', { ascending: false }),
          supabase
            .from('copropietarios')
            .select('id, nombre, propiedad, unidad_asignada')
        ]);
        if (resRegistros.error) throw resRegistros.error;
        if (resCopropietarios.error) throw resCopropietarios.error;
        setRegistros(resRegistros.data || []);
        setCopropietarios(resCopropietarios.data || []);
        setResultados(resRegistros.data || []);
      } catch (error) {
        setError(error.message);
      } finally {
        setLoading(false);
      }
    };
    cargarDatos();
  }, []);

  // Filtros din√°micos
  const propiedades = [...new Set(copropietarios.map(c => c.propiedad))].sort();
  const unidadesFiltradas = filtros.propiedad
    ? [...new Set(copropietarios.filter(c => c.propiedad === filtros.propiedad).map(c => c.unidad_asignada))]
    : [];

  // Manejar cambios en filtros
  const handleChange = (e) => {
    const { name, value } = e.target;
    setFiltros(prev => ({
      ...prev,
      [name]: value,
      ...(name === 'propiedad' && { unidadAsignada: '' })
    }));
  };

  // Aplicar filtros
  const aplicarFiltros = (e) => {
    e.preventDefault();
    let filtrados = [...registros];
    if (filtros.fechaInicio) {
      filtrados = filtrados.filter(r =>
        dayjs(r.fecha_hora_ingreso).isAfter(dayjs(filtros.fechaInicio).startOf('day'))
      );
    }
    if (filtros.fechaFin) {
      filtrados = filtrados.filter(r =>
        dayjs(r.fecha_hora_ingreso).isBefore(dayjs(filtros.fechaFin).endOf('day'))
      );
    }
    if (filtros.placa) {
      filtrados = filtrados.filter(r =>
        r.placa_vehiculo.toLowerCase().includes(filtros.placa.toLowerCase())
      );
    }
    if (filtros.tipoVehiculo) {
      filtrados = filtrados.filter(r =>
        r.tipo_vehiculo === filtros.tipoVehiculo
      );
    }
    if (filtros.propiedad) {
      filtrados = filtrados.filter(r =>
        r.copropietarios?.propiedad === filtros.propiedad
      );
    }
    if (filtros.unidadAsignada) {
      filtrados = filtrados.filter(r =>
        r.copropietarios?.unidad_asignada === filtros.unidadAsignada
      );
    }
    setResultados(filtrados);
  };

  // Limpiar filtros
  const limpiarFiltros = () => {
    setFiltros({
      fechaInicio: '',
      fechaFin: '',
      placa: '',
      propiedad: '',
      unidadAsignada: '',
      tipoVehiculo: ''
    });
    setResultados(registros);
  };

  // Manejar edici√≥n
  const abrirEdicion = (registro) => {
    setModal({ open: true, registro });
    setForm({
      placa_vehiculo: registro.placa_vehiculo,
      tipo_vehiculo: registro.tipo_vehiculo,
      fecha_hora_ingreso: dayjs(registro.fecha_hora_ingreso).format('YYYY-MM-DD'),
      dependencia_id: registro.dependencia_id,
      observaciones: registro.observaciones || '',
      monto: registro.monto,
      gratis: registro.gratis,
      recaudado: registro.recaudado,
      fecha_recaudo: registro.fecha_recaudo || ''
    });
  };

  // Guardar cambios
  const guardarCambios = async (e) => {
    e.preventDefault();
    setSaving(true);
    try {
      const { error } = await supabase
        .from('registros_parqueadero')
        .update({
          ...form,
          monto: form.gratis ? 0 : (form.tipo_vehiculo === 'carro' ? 1.00 : 0.50),
          fecha_recaudo: form.recaudado ? form.fecha_recaudo : null
        })
        .eq('id', modal.registro.id);
      if (error) throw error;
      const actualizados = registros.map(r =>
        r.id === modal.registro.id ? { ...r, ...form } : r
      );
      setRegistros(actualizados);
      setResultados(actualizados);
      setModal({ open: false, registro: null });
    } catch (error) {
      setError(error.message);
    } finally {
      setSaving(false);
    }
  };

  // Eliminar registro
  const eliminarRegistro = async (id) => {
    if (!window.confirm('¬øEliminar registro permanentemente?')) return;
    setDeleting(true);
    try {
      const { error } = await supabase
        .from('registros_parqueadero')
        .delete()
        .eq('id', id);
      if (error) throw error;
      const actualizados = registros.filter(r => r.id !== id);
      setRegistros(actualizados);
      setResultados(actualizados);
    } catch (error) {
      setError(error.message);
    } finally {
      setDeleting(false);
    }
  };

  if (loading) return <Loader />;
  if (error) return <ErrorMessage message={error} />;

  return (
    <div className="container mx-auto p-4">
      <h2 className="text-2xl font-bold mb-4">
        <Emoji symbol="üîé" /> Consulta de Registros
      </h2>

      {/* Filtros */}
      <form onSubmit={aplicarFiltros} className="bg-white p-4 rounded-lg shadow mb-4">
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          <div>
            <label className="block mb-1">Fecha Inicio</label>
            <input
              type="date"
              name="fechaInicio"
              value={filtros.fechaInicio}
              onChange={handleChange}
              className="w-full p-2 border rounded"
            />
          </div>
          <div>
            <label className="block mb-1">Fecha Fin</label>
            <input
              type="date"
              name="fechaFin"
              value={filtros.fechaFin}
              onChange={handleChange}
              className="w-full p-2 border rounded"
            />
          </div>
          <div>
            <label className="block mb-1">Placa</label>
            <input
              type="text"
              name="placa"
              value={filtros.placa}
              onChange={handleChange}
              placeholder="Buscar por placa"
              className="w-full p-2 border rounded"
            />
          </div>
          <div>
            <label className="block mb-1">Propiedad</label>
            <select
              name="propiedad"
              value={filtros.propiedad}
              onChange={handleChange}
              className="w-full p-2 border rounded"
            >
              <option value="">Todas</option>
              {propiedades.map(prop => (
                <option key={prop} value={prop}>{prop}</option>
              ))}
            </select>
          </div>
          <div>
            <label className="block mb-1">Unidad</label>
            <select
              name="unidadAsignada"
              value={filtros.unidadAsignada}
              onChange={handleChange}
              disabled={!filtros.propiedad}
              className="w-full p-2 border rounded"
            >
              <option value="">Todas</option>
              {unidadesFiltradas.map(unidad => (
                <option key={unidad} value={unidad}>{unidad}</option>
              ))}
            </select>
          </div>
          <div>
            <label className="block mb-1">Tipo Veh√≠culo</label>
            <select
              name="tipoVehiculo"
              value={filtros.tipoVehiculo}
              onChange={handleChange}
              className="w-full p-2 border rounded"
            >
              <option value="">Todos</option>
              <option value="carro">Carro</option>
              <option value="moto">Moto</option>
            </select>
          </div>
        </div>
        <div className="flex gap-2 mt-4">
          <button
            type="submit"
            className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
          >
            Aplicar Filtros
          </button>
          <button
            type="button"
            onClick={limpiarFiltros}
            className="bg-gray-600 text-white px-4 py-2 rounded hover:bg-gray-700"
          >
            Limpiar Filtros
          </button>
        </div>
      </form>

      {/* Tabla de resultados */}
      <div className="overflow-x-auto shadow ring-1 ring-black ring-opacity-5 rounded-lg">
        <table className="min-w-full divide-y divide-gray-300">
          <thead className="bg-gray-50">
            <tr>
              <th className="px-4 py-3">ID</th>
              <th className="px-4 py-3">Fecha/Hora</th>
              <th className="px-4 py-3">Placa</th>
              <th className="px-4 py-3">Tipo</th>
              <th className="px-4 py-3">Copropietario</th>
              <th className="px-4 py-3">Propiedad</th>
              <th className="px-4 py-3">Unidad</th>
              <th className="px-4 py-3">Observaciones</th>
              <th className="px-4 py-3">Monto</th>
              <th className="px-4 py-3">Gratis</th>
              <th className="px-4 py-3">Recaudado</th>
              <th className="px-4 py-3">Fecha Recaudo</th>
              <th className="px-4 py-3">Registrado por</th>
              <th className="px-4 py-3">Rol usuario</th>
              <th className="px-4 py-3">Foto</th>
              <th className="px-4 py-3">Audio</th>
              <th className="px-4 py-3">Acciones</th>
            </tr>
          </thead>
          <tbody className="divide-y divide-gray-200 bg-white">
            {resultados.map(registro => (
              <tr key={registro.id} className="hover:bg-gray-50">
                <td className="px-4 py-3">{registro.id}</td>
                <td className="px-4 py-3">{registro.fecha_hora_ingreso ? dayjs(registro.fecha_hora_ingreso).format('DD/MM/YYYY HH:mm') : ''}</td>
                <td className="px-4 py-3">{registro.placa_vehiculo}</td>
                <td className="px-4 py-3">
                  <Emoji symbol={registro.tipo_vehiculo === 'carro' ? 'üöó' : 'üèçÔ∏è'} />
                  {registro.tipo_vehiculo}
                </td>
                <td className="px-4 py-3">{registro.copropietarios?.nombre || '-'}</td>
                <td className="px-4 py-3">{registro.copropietarios?.propiedad || '-'}</td>
                <td className="px-4 py-3">{registro.copropietarios?.unidad_asignada || '-'}</td>
                <td className="px-4 py-3">{registro.observaciones || '-'}</td>
                <td className="px-4 py-3">${Number(registro.monto).toFixed(2)}</td>
                <td className="px-4 py-3">
                  {registro.gratis ? <Emoji symbol="üÜì" /> : <Emoji symbol="‚ùå" />}
                </td>
                <td className="px-4 py-3">
                  {registro.recaudado ? <Emoji symbol="üîó" /> : <Emoji symbol="‚è≥" />}
                </td>
                <td className="px-4 py-3">{registro.fecha_recaudo || '-'}</td>
                <td className="px-4 py-3">{registro.usuarios_app?.nombre || '-'}</td>
                <td className="px-4 py-3">{registro.usuarios_app?.rol || '-'}</td>
                <td className="px-4 py-3">
                  {registro.foto_url && (
                    <a href={registro.foto_url} target="_blank" rel="noopener noreferrer">
                      <img src={registro.foto_url} alt="Evidencia" className="thumbnail" />
                    </a>
                  )}
                </td>
                <td className="px-4 py-3">
                  {registro.observacion_audio_url ? (
                    <audio controls style={{ width: 90 }}>
                      <source src={registro.observacion_audio_url} type="audio/webm" />
                      Tu navegador no soporta audio.
                    </audio>
                  ) : (
                    <span style={{ color: '#aaa', fontSize: 14 }}>-</span>
                  )}
                </td>
                <td className="px-4 py-3 space-x-2">
                  <button
                    onClick={() => abrirEdicion(registro)}
                    className="text-blue-600 hover:text-blue-800"
                    disabled={!isOnline}
                  >
                    Editar
                  </button>
                  <button
                    onClick={() => eliminarRegistro(registro.id)}
                    className="text-red-600 hover:text-red-800"
                    disabled={!isOnline}
                  >
                    Eliminar
                  </button>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {/* Modal de edici√≥n */}
      <Modal isOpen={modal.open} onClose={() => setModal({ open: false })}>
        <div className="p-6">
          <h3 className="text-xl font-bold mb-4">Editar Registro</h3>
          <form onSubmit={guardarCambios} className="space-y-4">
            <div>
              <label>Placa:</label>
              <input
                value={form.placa_vehiculo}
                onChange={e => setForm({ ...form, placa_vehiculo: e.target.value })}
                className="w-full p-2 border rounded"
                required
              />
            </div>
            <div>
              <label>Tipo:</label>
              <select
                value={form.tipo_vehiculo}
                onChange={e => setForm({ ...form, tipo_vehiculo: e.target.value })}
                className="w-full p-2 border rounded"
                required
              >
                <option value="carro">Carro</option>
                <option value="moto">Moto</option>
              </select>
            </div>
            <div>
              <label>Fecha:</label>
              <input
                type="date"
                value={form.fecha_hora_ingreso}
                onChange={e => setForm({ ...form, fecha_hora_ingreso: e.target.value })}
                className="w-full p-2 border rounded"
                required
              />
            </div>
            <div>
              <label>Copropietario:</label>
              <select
                value={form.dependencia_id}
                onChange={e => setForm({ ...form, dependencia_id: e.target.value })}
                className="w-full p-2 border rounded"
                required
              >
                <option value="">Seleccionar...</option>
                {copropietarios.map(c => (
                  <option key={c.id} value={c.id}>
                    {c.nombre} ({c.propiedad} - {c.unidad_asignada})
                  </option>
                ))}
              </select>
            </div>
            <div className="flex justify-end gap-2">
              <button
                type="button"
                onClick={() => setModal({ open: false })}
                className="bg-gray-500 text-white px-4 py-2 rounded"
              >
                Cancelar
              </button>
              <button
                type="submit"
                className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"
                disabled={saving}
              >
                {saving ? 'Guardando...' : 'Guardar'}
              </button>
            </div>
          </form>
        </div>
      </Modal>
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\pages\DescargoGestion.jsx -----

import React, { useState, useEffect } from "react";
import { useForm, Controller } from "react-hook-form";
import DatePicker from "react-datepicker";
import "react-datepicker/dist/react-datepicker.css";
import supabase from "../supabaseClient";
import dayjs from "dayjs";

// Error Boundary para capturar errores en el componente
class ErrorBoundary extends React.Component {
  constructor(props) {
    super(props);
    this.state = { hasError: false };
  }
  static getDerivedStateFromError(error) {
    return { hasError: true };
  }
  componentDidCatch(error, errorInfo) {
    console.error("Error en DescargoGestion:", error, errorInfo);
  }
  render() {
    if (this.state.hasError) {
      return (
        <div style={{ color: "#b91c1c", padding: 20 }}>
          ‚ö†Ô∏è Ha ocurrido un error al cargar el componente. Por favor recargue la p√°gina.
        </div>
      );
    }
    return this.props.children;
  }
}

// Polyfill para crypto.randomUUID si no existe
if (typeof window !== "undefined" && (!window.crypto || !window.crypto.randomUUID)) {
  if (!window.crypto) window.crypto = {};
  window.crypto.randomUUID = function () {
    return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (c) {
      const r = (Math.random() * 16) | 0,
        v = c === "x" ? r : (r & 0x3) | 0x8;
      return v.toString(16);
    });
  };
}

const Emoji = ({ symbol, label }) => (
  <span role="img" aria-label={label || ""} style={{ marginRight: 6 }}>
    {symbol}
  </span>
);

const AdjuntosPreview = ({ archivos, onRemove }) => (
  <div style={{ display: "flex", gap: 8, flexWrap: "wrap" }}>
    {archivos &&
      archivos.map((archivo, idx) => {
        // Adaptar: si archivo es string, se convierte a objeto {url}
        const url = typeof archivo === "string" ? archivo : archivo.url;
        const name = archivo.name || `Archivo ${idx + 1}`;
        const type = archivo.type || "";
        const isImage =
          type.startsWith("image/") ||
          /\.(jpe?g|png|gif|bmp|webp)$/i.test(url);

        return (
          <div key={idx} style={{ position: "relative", width: 70, textAlign: "center" }}>
            {onRemove && (
              <button
                onClick={() => onRemove(idx)}
                style={{
                  position: "absolute",
                  top: -8,
                  right: -8,
                  background: "#dc2626",
                  color: "white",
                  border: "none",
                  borderRadius: "50%",
                  width: 20,
                  height: 20,
                  cursor: "pointer",
                  display: "flex",
                  alignItems: "center",
                  justifyContent: "center",
                  fontSize: 12,
                }}
                title="Eliminar archivo"
              >
                √ó
              </button>
            )}
            {isImage ? (
              <img
                src={url}
                alt={name}
                style={{
                  width: 70,
                  height: 70,
                  objectFit: "cover",
                  borderRadius: 6,
                  border: "1px solid #ccc",
                }}
              />
            ) : (
              <div
                style={{
                  width: 70,
                  height: 70,
                  display: "flex",
                  alignItems: "center",
                  justifyContent: "center",
                  backgroundColor: "#f0f0f0",
                  borderRadius: 6,
                  border: "1px solid #ccc",
                  fontSize: 28,
                  color: "#666",
                }}
              >
                üìÑ
              </div>
            )}
            <a
              href={url}
              download={name}
              target="_blank"
              rel="noopener noreferrer"
              style={{
                display: "block",
                fontSize: 11,
                marginTop: 4,
                color: "#0366d6",
                textDecoration: "none",
                wordBreak: "break-word",
              }}
            >
              {name.length > 15 ? name.slice(0, 12) + "..." : name}
            </a>
          </div>
        );
      })}
  </div>
);

function DescargoGestionComponent() {
  const {
    register,
    handleSubmit,
    control,
    reset,
    watch,
    setValue,
    formState: { errors, isSubmitting },
  } = useForm({
    defaultValues: {
      descripcion: "",
      fecha: new Date(),
      esfuerzo: [],
      monto: "",
      horas: "",
      materiales: "",
      observaciones: "",
      archivos: [],
    },
  });

  const [mensaje, setMensaje] = useState("");
  const [subiendo, setSubiendo] = useState(false);
  const [archivosPreview, setArchivosPreview] = useState([]);
  const [registros, setRegistros] = useState([]);
  const [loadingRegistros, setLoadingRegistros] = useState(false);
  const [errorRegistros, setErrorRegistros] = useState(null);
  const [editId, setEditId] = useState(null);
  const [editRow, setEditRow] = useState({});

  const esfuerzosDisponibles = [
    { valor: "econ√≥mico", etiqueta: "üí≤ Econ√≥mico" },
    { valor: "participativo", etiqueta: "ü§ù Participativo" },
    { valor: "utilitarios", etiqueta: "üõ†Ô∏è Utilitarios" },
  ];

  const archivos = watch("archivos");

  useEffect(() => {
    if (!archivos || archivos.length === 0) {
      setArchivosPreview([]);
      return;
    }
    const previews = Array.from(archivos).map((file) => ({
      url: URL.createObjectURL(file),
      name: file.name,
      type: file.type,
    }));
    setArchivosPreview(previews);
    return () => {
      previews.forEach((p) => URL.revokeObjectURL(p.url));
    };
    // eslint-disable-next-line
  }, [archivos]);

  const fetchRegistros = async () => {
    setLoadingRegistros(true);
    setErrorRegistros(null);
    try {
      const { data, error } = await supabase
        .from("descargos_gestion")
        .select("*")
        .order("fecha", { ascending: false });
      if (error) throw error;
      setRegistros(data || []);
    } catch (error) {
      setErrorRegistros(error.message);
    } finally {
      setLoadingRegistros(false);
    }
  };

  useEffect(() => {
    fetchRegistros();
  }, []);

  const handleArchivos = (e) => {
    const files = Array.from(e.target.files);
    setValue("archivos", files, { shouldValidate: true });
  };

  // --- CREAR NUEVO REGISTRO ---
  const onSubmit = async (data) => {
    setMensaje("");
    setSubiendo(true);

    try {
      let archivosUrls = [];
      if (data.archivos && data.archivos.length > 0) {
        for (const file of data.archivos) {
          const ext = file.name.split(".").pop();
          const nombre = `descargo_${Date.now()}_${window.crypto.randomUUID()}.${ext}`;
          const { error: uploadError } = await supabase.storage
            .from("descargos-evidencias")
            .upload(nombre, file, { upsert: false });
          if (uploadError) throw uploadError;

          const { data: urlData } = supabase.storage
            .from("descargos-evidencias")
            .getPublicUrl(nombre);
          archivosUrls.push(urlData.publicUrl); // SOLO URL
        }
      }

      const nuevoRegistro = {
        descripcion: data.descripcion,
        fecha: data.fecha.toISOString(),
        esfuerzo: data.esfuerzo,
        monto: data.monto ? Number(data.monto) : null,
        horas: data.horas ? Number(data.horas) : null,
        materiales: data.materiales || null,
        observaciones: data.observaciones || null,
        archivos: archivosUrls, // SOLO ARRAY DE URLS
      };

      const { error: insertError } = await supabase
        .from("descargos_gestion")
        .insert([nuevoRegistro]);
      if (insertError) throw insertError;

      setMensaje("‚úÖ Descargo registrado exitosamente.");
      reset();
      setArchivosPreview([]);
      fetchRegistros();
    } catch (error) {
      setMensaje(`‚ö†Ô∏è Error: ${error.message}`);
    } finally {
      setSubiendo(false);
    }
  };

  // --- AGREGAR ARCHIVOS AL EDITAR ---
  const handleEditFiles = async (e) => {
    const files = Array.from(e.target.files);
    const nuevosArchivos = [];
    for (const file of files) {
      const ext = file.name.split(".").pop();
      const nombre = `descargo_${Date.now()}_${window.crypto.randomUUID()}.${ext}`;
      const { error } = await supabase.storage
        .from("descargos-evidencias")
        .upload(nombre, file, { upsert: false });
      if (error) throw error;
      const { data: urlData } = supabase.storage
        .from("descargos-evidencias")
        .getPublicUrl(nombre);
      nuevosArchivos.push(urlData.publicUrl); // SOLO URL
    }
    setEditRow((prev) => ({
      ...prev,
      archivos: [...(prev.archivos || []), ...nuevosArchivos], // SOLO URLS
    }));
  };

  // --- ELIMINAR ARCHIVO EN EDICI√ìN ---
  const handleRemoveFile = (index) => {
    setEditRow((prev) => ({
      ...prev,
      archivos: prev.archivos.filter((_, i) => i !== index),
    }));
  };

  // --- GUARDAR EDICI√ìN ---
  const guardarEdicion = async () => {
    try {
      await supabase
        .from("descargos_gestion")
        .update({
          ...editRow,
          fecha: editRow.fecha.toISOString(),
          archivos: editRow.archivos, // SOLO URLS
        })
        .eq("id", editId);
      fetchRegistros();
      setEditId(null);
    } catch (error) {
      setMensaje(`‚ùå Error al actualizar: ${error.message}`);
    }
  };

  // --- ADAPTADOR PARA PREVIEW ---
  const archivosPreviewAdapt = (arr) =>
    arr?.map((a) => (typeof a === "string" ? { url: a } : a)) || [];

  // --- MANEJO DE ESFUERZO EN EDICI√ìN ---
  const handleEditEsfuerzo = (e) => {
    const { options } = e.target;
    const selected = [];
    for (let i = 0; i < options.length; i++) {
      if (options[i].selected) selected.push(options[i].value);
    }
    setEditRow((prev) => ({
      ...prev,
      esfuerzo: selected,
    }));
  };

  return (
    <div
      style={{
        background: "linear-gradient(135deg, #e0e7ff 0%, #f8fafc 100%)",
        borderRadius: 24,
        boxShadow: "0 6px 32px #6366f133",
        padding: "2.5rem 1.5rem",
        maxWidth: 1200,
        margin: "2.5rem auto",
      }}
    >
      <h2
        style={{
          display: "flex",
          alignItems: "center",
          gap: 10,
          fontWeight: 700,
          fontSize: "1.6rem",
          marginBottom: 16,
        }}
      >
        <Emoji symbol="üìù" /> Descargo de Gesti√≥n
      </h2>

      <form
        onSubmit={handleSubmit(onSubmit)}
        autoComplete="off"
        style={{ display: "flex", flexDirection: "column", gap: 20 }}
        noValidate
      >
        <div>
          <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
            <Emoji symbol="üìÑ" /> Descripci√≥n del descargo *
          </label>
          <textarea
            {...register("descripcion", { required: "Campo obligatorio" })}
            style={{
              width: "100%",
              padding: "8px 12px",
              borderRadius: 8,
              border: errors.descripcion ? "2px solid #dc2626" : "1px solid #94a3b8",
              minHeight: 100,
            }}
            placeholder="Detalle las actividades realizadas..."
          />
          {errors.descripcion && (
            <span style={{ color: "#dc2626", fontSize: 14 }}>
              {errors.descripcion.message}
            </span>
          )}
        </div>

        <div>
          <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
            <Emoji symbol="üìÖ" /> Fecha del descargo *
          </label>
          <Controller
            control={control}
            name="fecha"
            rules={{ required: true }}
            render={({ field }) => (
              <DatePicker
                selected={field.value}
                onChange={(date) => field.onChange(date)}
                dateFormat="dd/MM/yyyy"
                className="custom-datepicker"
                showTimeSelect
              />
            )}
          />
        </div>

        <div>
          <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
            <Emoji symbol="üí™" /> Tipo de esfuerzo *
          </label>
          <div style={{ display: "flex", gap: 16, flexWrap: "wrap" }}>
            {esfuerzosDisponibles.map((esfuerzo) => (
              <label key={esfuerzo.valor} style={{ display: "flex", alignItems: "center" }}>
                <input
                  type="checkbox"
                  value={esfuerzo.valor}
                  {...register("esfuerzo", {
                    validate: (value) =>
                      value.length > 0 || "Seleccione al menos un tipo de esfuerzo",
                  })}
                  style={{ marginRight: 6 }}
                />
                {esfuerzo.etiqueta}
              </label>
            ))}
          </div>
          {errors.esfuerzo && (
            <span style={{ color: "#dc2626", fontSize: 14 }}>
              {errors.esfuerzo.message}
            </span>
          )}
        </div>

        <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 20 }}>
          <div>
            <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
              <Emoji symbol="üí≤" /> Monto econ√≥mico (opcional)
            </label>
            <input
              type="number"
              {...register("monto")}
              style={{
                width: "100%",
                padding: "8px 12px",
                borderRadius: 8,
                border: "1px solid #94a3b8",
              }}
              placeholder="Ingrese el monto en USD"
            />
          </div>

          <div>
            <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
              <Emoji symbol="‚è≥" /> Horas invertidas (opcional)
            </label>
            <input
              type="number"
              {...register("horas")}
              style={{
                width: "100%",
                padding: "8px 12px",
                borderRadius: 8,
                border: "1px solid #94a3b8",
              }}
              placeholder="Horas totales"
            />
          </div>
        </div>

        <div>
          <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
            <Emoji symbol="üõ†Ô∏è" /> Materiales utilizados (opcional)
          </label>
          <input
            type="text"
            {...register("materiales")}
            style={{
              width: "100%",
              padding: "8px 12px",
              borderRadius: 8,
              border: "1px solid #94a3b8",
            }}
            placeholder="Liste los materiales separados por comas"
          />
        </div>

        <div>
          <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
            <Emoji symbol="üìã" /> Observaciones adicionales (opcional)
          </label>
          <textarea
            {...register("observaciones")}
            style={{
              width: "100%",
              padding: "8px 12px",
              borderRadius: 8,
              border: "1px solid #94a3b8",
              minHeight: 80,
            }}
            placeholder="Agregue cualquier comentario adicional..."
          />
        </div>

        <div>
          <label style={{ display: "block", marginBottom: 6, fontWeight: 500 }}>
            <Emoji symbol="üìé" /> Adjuntar evidencias (opcional)
          </label>
          <input
            type="file"
            multiple
            onChange={handleArchivos}
            accept="image/*,audio/*"
            style={{ marginBottom: 12 }}
          />
          <AdjuntosPreview archivos={archivosPreview} />
        </div>

        <button
          type="submit"
          className="btn-modern"
          disabled={isSubmitting || subiendo}
          style={{
            backgroundColor: "#4338ca",
            color: "white",
            padding: "10px 16px",
            borderRadius: 8,
            border: "none",
            fontSize: 16,
            cursor: isSubmitting || subiendo ? "not-allowed" : "pointer",
            opacity: isSubmitting || subiendo ? 0.6 : 1,
            transition: "background-color 0.3s",
          }}
        >
          {subiendo ? "Enviando..." : "Registrar Descargo"}
        </button>
        {mensaje && (
          <div
            style={{
              marginTop: 8,
              color: mensaje.startsWith("‚úÖ") ? "#16a34a" : "#b91c1c",
              fontWeight: 500,
            }}
          >
            {mensaje}
          </div>
        )}
      </form>

      <div style={{ marginTop: 48, overflowX: "auto" }}>
        <h3 style={{ fontSize: "1.3rem", marginBottom: 16 }}>
          <Emoji symbol="üìã" /> Registros existentes
        </h3>

        {loadingRegistros ? (
          <div>Cargando registros...</div>
        ) : errorRegistros ? (
          <div style={{ color: "#dc2626" }}>Error: {errorRegistros}</div>
        ) : (
          <table style={{ width: "100%", borderCollapse: "collapse", fontSize: 14 }}>
            <thead>
              <tr style={{ backgroundColor: "#e0e7ff" }}>
                <th style={{ padding: 12 }}>Fecha</th>
                <th style={{ padding: 12 }}>Descripci√≥n</th>
                <th style={{ padding: 12 }}>Esfuerzo</th>
                <th style={{ padding: 12 }}>Archivos</th>
                <th style={{ padding: 12 }}>Acciones</th>
              </tr>
            </thead>
            <tbody>
              {registros.map((reg) =>
                editId === reg.id ? (
                  <tr key={reg.id} style={{ borderBottom: "1px solid #e2e8f0", background: "#f8fafc" }}>
                    <td style={{ padding: 12 }}>
                      <DatePicker
                        selected={editRow.fecha}
                        onChange={(date) => setEditRow((prev) => ({ ...prev, fecha: date }))}
                        dateFormat="dd/MM/yyyy"
                        showTimeSelect
                      />
                    </td>
                    <td style={{ padding: 12 }}>
                      <input
                        name="descripcion"
                        value={editRow.descripcion}
                        onChange={e => setEditRow(prev => ({ ...prev, descripcion: e.target.value }))}
                        style={{ width: "100%" }}
                      />
                    </td>
                    <td style={{ padding: 12 }}>
                      <select
                        name="esfuerzo"
                        value={editRow.esfuerzo}
                        onChange={handleEditEsfuerzo}
                        multiple
                        style={{ width: "100%" }}
                      >
                        {esfuerzosDisponibles.map((esf) => (
                          <option key={esf.valor} value={esf.valor}>
                            {esf.etiqueta}
                          </option>
                        ))}
                      </select>
                    </td>
                    <td style={{ padding: 12 }}>
                      <input
                        type="file"
                        multiple
                        onChange={handleEditFiles}
                        style={{ marginBottom: 8 }}
                      />
                      <AdjuntosPreview archivos={archivosPreviewAdapt(editRow.archivos)} onRemove={handleRemoveFile} />
                    </td>
                    <td style={{ padding: 12 }}>
                      <button
                        onClick={guardarEdicion}
                        style={{ marginRight: 8, background: "none", border: "none", cursor: "pointer" }}
                        title="Guardar"
                      >
                        üíæ
                      </button>
                      <button
                        onClick={() => setEditId(null)}
                        style={{ background: "none", border: "none", cursor: "pointer" }}
                        title="Cancelar"
                      >
                        ‚ùå
                      </button>
                    </td>
                  </tr>
                ) : (
                  <tr key={reg.id} style={{ borderBottom: "1px solid #e2e8f0" }}>
                    <td style={{ padding: 12 }}>{dayjs(reg.fecha).format("DD/MM/YYYY HH:mm")}</td>
                    <td style={{ padding: 12 }}>{reg.descripcion}</td>
                    <td style={{ padding: 12 }}>
                      {reg.esfuerzo?.map(
                        (e) => esfuerzosDisponibles.find((esf) => esf.valor === e)?.etiqueta
                      ).join(", ")}
                    </td>
                    <td style={{ padding: 12 }}>
                      <AdjuntosPreview archivos={archivosPreviewAdapt(reg.archivos)} />
                    </td>
                    <td style={{ padding: 12 }}>
                      <button
                        onClick={() => setEditId(reg.id) || setEditRow({ ...reg, fecha: new Date(reg.fecha) })}
                        style={{ marginRight: 8, background: "none", border: "none", cursor: "pointer" }}
                        title="Editar"
                      >
                        ‚úèÔ∏è
                      </button>
                      <button
                        onClick={() => handleEliminar(reg.id)}
                        style={{ background: "none", border: "none", cursor: "pointer" }}
                        title="Eliminar"
                      >
                        üóëÔ∏è
                      </button>
                    </td>
                  </tr>
                )
              )}
            </tbody>
          </table>
        )}
      </div>
    </div>
  );
}

// Exportar el componente envuelto en ErrorBoundary
export default function DescargoGestion() {
  return (
    <ErrorBoundary>
      <DescargoGestionComponent />
    </ErrorBoundary>
  );
}


----- C:\ThomasParking\ThomasParking\src\pages\GestionCopropietarios.jsx -----

import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import supabase from '../supabaseClient';
import Loader from '../components/Loader';
import Emoji from '../components/Emoji';
import ErrorMessage from '../components/ErrorMessage';
import Modal from '../components/Modal';

export default function GestionCopropietarios() {
  const [copropietarios, setCopropietarios] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [modal, setModal] = useState({ 
    open: false, 
    copropietario: null 
  });
  const [form, setForm] = useState({ 
    nombre: '', 
    propiedad: '', 
    unidad_asignada: '' 
  });
  const navigate = useNavigate();

  const fetchCopropietarios = async () => {
    setLoading(true);
    setError(null);
    try {
      const { data, error } = await supabase
        .from('copropietarios')
        .select('*')
        .order('propiedad', { ascending: true });

      if (error) throw error;
      setCopropietarios(data);
    } catch (err) {
      setError(err.message);
    }
    setLoading(false);
  };

  useEffect(() => { 
    fetchCopropietarios();
  }, []);

  const handleSubmit = async (e) => {
    e.preventDefault();
    setError(null);
    
    if (!form.nombre || !form.propiedad || !form.unidad_asignada) {
      setError('Todos los campos son obligatorios');
      return;
    }

    try {
      if (modal.copropietario) {
        // Actualizar
        const { error } = await supabase
          .from('copropietarios')
          .update(form)
          .eq('id', modal.copropietario.id);

        if (error) throw error;
      } else {
        // Crear nuevo
        const { error } = await supabase
          .from('copropietarios')
          .insert([form])
          .select();

        if (error) throw error;
      }

      setModal({ open: false, copropietario: null });
      setForm({ nombre: '', propiedad: '', unidad_asignada: '' });
      await fetchCopropietarios();
    } catch (err) {
      setError(err.message);
    }
  };

  const handleDelete = async (id) => {
    if (!window.confirm('¬øEliminar copropietario?')) return;
    setError(null);
    
    try {
      const { error } = await supabase
        .from('copropietarios')
        .delete()
        .eq('id', id);

      if (error) throw error;
      await fetchCopropietarios();
    } catch (err) {
      setError(err.message);
    }
  };

  const handleEdit = (copropietario) => {
    setForm({
      nombre: copropietario.nombre,
      propiedad: copropietario.propiedad,
      unidad_asignada: copropietario.unidad_asignada
    });
    setModal({ open: true, copropietario });
  };

  return (
    <div className="container mx-auto p-4">
      <h2 className="text-2xl font-bold mb-4">
        <Emoji symbol="üë•" /> Gesti√≥n de Copropietarios
      </h2>

      <button 
        onClick={() => setModal({ open: true, copropietario: null })}
        className="bg-blue-600 text-white px-4 py-2 rounded mb-4 hover:bg-blue-700 transition-colors"
      >
        <Emoji symbol="‚ûï" /> Nuevo Copropietario
      </button>

      {loading ? <Loader /> : error ? <ErrorMessage message={error} /> : (
        <div className="overflow-x-auto shadow ring-1 ring-black ring-opacity-5 rounded-lg">
          <table className="min-w-full divide-y divide-gray-300">
            <thead className="bg-gray-50">
              <tr>
                <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">
                  <Emoji symbol="üßë" /> Nombre
                </th>
                <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">
                  <Emoji symbol="üè¢" /> Propiedad
                </th>
                <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">
                  <Emoji symbol="üî¢" /> Unidad
                </th>
                <th className="px-4 py-3 text-left text-sm font-semibold text-gray-900">
                  <Emoji symbol="‚öôÔ∏è" /> Acciones
                </th>
              </tr>
            </thead>
            <tbody className="divide-y divide-gray-200 bg-white">
              {copropietarios.map(c => (
                <tr key={c.id} className="hover:bg-gray-50">
                  <td className="whitespace-nowrap px-4 py-4 text-sm text-gray-900">
                    {c.nombre}
                  </td>
                  <td className="whitespace-nowrap px-4 py-4 text-sm text-gray-900">
                    {c.propiedad}
                  </td>
                  <td className="whitespace-nowrap px-4 py-4 text-sm text-gray-900">
                    {c.unidad_asignada}
                  </td>
                  <td className="whitespace-nowrap px-4 py-4 text-sm space-x-2">
                    <button
                      onClick={() => handleEdit(c)}
                      className="text-blue-600 hover:text-blue-900"
                    >
                      <Emoji symbol="‚úèÔ∏è" /> Editar
                    </button>
                    <button
                      onClick={() => handleDelete(c.id)}
                      className="text-red-600 hover:text-red-900"
                    >
                      <Emoji symbol="üóëÔ∏è" /> Eliminar
                    </button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      )}

      <Modal isOpen={modal.open} onClose={() => setModal({ open: false })}>
        <div className="p-6">
          <h3 className="text-xl font-bold mb-4">
            <Emoji symbol={modal.copropietario ? "‚úèÔ∏è" : "‚ûï"} /> 
            {modal.copropietario ? 'Editar' : 'Nuevo'} Copropietario
          </h3>
          
          <form onSubmit={handleSubmit} className="space-y-4">
            <div>
              <label className="block text-sm font-medium mb-1">
                <Emoji symbol="üßë" /> Nombre completo
              </label>
              <input
                value={form.nombre}
                onChange={e => setForm({ ...form, nombre: e.target.value })}
                required
                className="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              />
            </div>

            <div>
              <label className="block text-sm font-medium mb-1">
                <Emoji symbol="üè¢" /> Propiedad
              </label>
              <input
                value={form.propiedad}
                onChange={e => setForm({ ...form, propiedad: e.target.value })}
                required
                className="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              />
            </div>

            <div>
              <label className="block text-sm font-medium mb-1">
                <Emoji symbol="üî¢" /> Unidad asignada
              </label>
              <input
                value={form.unidad_asignada}
                onChange={e => setForm({ ...form, unidad_asignada: e.target.value })}
                required
                className="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              />
            </div>

            <div className="flex justify-end space-x-3 mt-6">
              <button
                type="button"
                onClick={() => setModal({ open: false })}
                className="px-4 py-2 border rounded hover:bg-gray-100 transition-colors"
              >
                Cancelar
              </button>
              <button
                type="submit"
                className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
              >
                {modal.copropietario ? 'Actualizar' : 'Crear'}
              </button>
            </div>
          </form>
        </div>
      </Modal>
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\pages\GestionUsuarios.jsx -----

import React, { useState, useEffect } from 'react';
import supabase from '../supabaseClient';
import Loader from '../components/Loader';
import Emoji from '../components/Emoji';

export default function GestionUsuarios() {
  const [usuarios, setUsuarios] = useState([]);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);
  const [modal, setModal] = useState({ open: false, usuario: null });
  const [form, setForm] = useState({ 
    nombre: '', 
    email: '',
    rol: 'registrador', 
    activo: true 
  });
  const [saving, setSaving] = useState(false);
  const [deleting, setDeleting] = useState(false);

  // Leer usuarios con validaci√≥n
  const fetchUsuarios = async () => {
    try {
      setLoading(true);
      setError(null);
      
      const { data, error } = await supabase
        .from('usuarios_app')
        .select('id, nombre, email, rol, activo')
        .order('nombre', { ascending: true });

      if (error) throw error;
      setUsuarios(Array.isArray(data) ? data : []);
    } catch (err) {
      setError(err.message || 'Error cargando usuarios');
    } finally {
      setLoading(false);
    }
  };

  useEffect(() => { 
    fetchUsuarios();
  }, []);

  // Validar formulario
  const validateForm = () => {
    if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(form.email)) {
      setError('Email inv√°lido');
      return false;
    }
    if (form.nombre.trim().length < 3) {
      setError('Nombre debe tener al menos 3 caracteres');
      return false;
    }
    return true;
  };

  // Abrir modal para editar/crear
  const handleEdit = (usuario) => {
    setForm({
      nombre: usuario.nombre,
      email: usuario.email,
      rol: usuario.rol,
      activo: usuario.activo
    });
    setModal({ open: true, usuario });
  };

  const handleNew = () => {
    setForm({ nombre: '', email: '', rol: 'registrador', activo: true });
    setModal({ open: true, usuario: null });
  };

  // Guardar usuario
  const handleSave = async (e) => {
    e.preventDefault();
    if (!validateForm()) return;
    
    setSaving(true);
    setError(null);

    try {
      const usuarioData = {
        nombre: form.nombre.trim(),
        email: form.email.trim().toLowerCase(),
        rol: form.rol,
        activo: form.activo
      };

      if (modal.usuario) {
        // Edici√≥n
        const { error } = await supabase
          .from('usuarios_app')
          .update(usuarioData)
          .eq('id', modal.usuario.id);
          
        if (error) throw error;
      } else {
        // Creaci√≥n
        const { error } = await supabase
          .from('usuarios_app')
          .insert([usuarioData]);

        if (error) throw error;
      }

      setModal({ open: false, usuario: null });
      await fetchUsuarios();
    } catch (err) {
      setError(err.message || 'Error guardando usuario');
    } finally {
      setSaving(false);
    }
  };

  // Eliminar usuario
  const handleDelete = async (usuario) => {
    if (!window.confirm(`¬øEliminar usuario ${usuario.email}?`)) return;
    
    setDeleting(true);
    setError(null);

    try {
      const { error } = await supabase
        .from('usuarios_app')
        .delete()
        .eq('id', usuario.id);

      if (error) throw error;
      
      await fetchUsuarios();
    } catch (err) {
      setError(err.message || 'Error eliminando usuario');
    } finally {
      setDeleting(false);
    }
  };

  if (loading) return <Loader text="Cargando usuarios..." />;

  return (
    <div className="container mx-auto p-4">
      <h2 className="text-2xl font-bold mb-4 flex items-center gap-2">
        <Emoji symbol="üë•" /> Gesti√≥n de Usuarios
      </h2>

      <div className="mb-4">
        <button 
          className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2"
          onClick={handleNew}
        >
          <Emoji symbol="‚ûï" /> Nuevo usuario
        </button>
      </div>

      <div className="overflow-x-auto">
        <table className="w-full border-collapse">
          <thead className="bg-gray-100">
            <tr>
              <th className="p-3 text-left"><Emoji symbol="üßë" /> Nombre</th>
              <th className="p-3 text-left"><Emoji symbol="‚úâÔ∏è" /> Email</th>
              <th className="p-3 text-left"><Emoji symbol="üéñÔ∏è" /> Rol</th>
              <th className="p-3 text-left"><Emoji symbol="‚úîÔ∏è" /> Estado</th>
              <th className="p-3 text-left"><Emoji symbol="‚öôÔ∏è" /> Acciones</th>
            </tr>
          </thead>
          <tbody>
            {usuarios.map(u => (
              <tr key={u.id} className="border-b hover:bg-gray-50">
                <td className="p-3">{u.nombre}</td>
                <td className="p-3">{u.email}</td>
                <td className="p-3">
                  <span className={`inline-block px-2 py-1 rounded ${u.rol === 'admin' ? 'bg-purple-100 text-purple-800' : 'bg-blue-100 text-blue-800'}`}>
                    {u.rol === 'admin' 
                      ? <><Emoji symbol="üëë" /> Admin</>
                      : u.rol === 'copropietario'
                        ? <><Emoji symbol="üè†" /> Copropietario</>
                        : <><Emoji symbol="üìã" /> Registrador</>}
                  </span>
                </td>
                <td className="p-3">
                  <span className={`inline-block px-2 py-1 rounded ${u.activo ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}`}>
                    {u.activo ? <Emoji symbol="‚úÖ" /> : <Emoji symbol="‚ùå" />}
                  </span>
                </td>
                <td className="p-3 flex gap-2">
                  <button 
                    className="text-blue-600 hover:text-blue-800"
                    onClick={() => handleEdit(u)}
                    disabled={deleting}
                  >
                    <Emoji symbol="‚úèÔ∏è" />
                  </button>
                  <button 
                    className="text-red-600 hover:text-red-800"
                    onClick={() => handleDelete(u)}
                    disabled={deleting}
                  >
                    <Emoji symbol="üóëÔ∏è" />
                  </button>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>

      {error && (
        <div className="mt-4 p-3 bg-red-100 text-red-700 rounded-lg">
          <Emoji symbol="‚ùå" /> {error}
        </div>
      )}

      {/* Modal de edici√≥n */}
      {modal.open && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center">
          <div className="bg-white rounded-lg p-6 max-w-md w-full">
            <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
              <Emoji symbol={modal.usuario ? "‚úèÔ∏è" : "‚ûï"} />
              {modal.usuario ? 'Editar Usuario' : 'Nuevo Usuario'}
            </h3>

            <form onSubmit={handleSave} className="space-y-4">
              <div>
                <label className="block mb-2 font-medium"><Emoji symbol="üßë" /> Nombre:</label>
                <input
                  type="text"
                  value={form.nombre}
                  onChange={e => setForm({...form, nombre: e.target.value})}
                  className="w-full p-2 border rounded"
                  required
                  minLength="3"
                />
              </div>

              <div>
                <label className="block mb-2 font-medium"><Emoji symbol="‚úâÔ∏è" /> Email:</label>
                <input
                  type="email"
                  value={form.email}
                  onChange={e => setForm({...form, email: e.target.value})}
                  className="w-full p-2 border rounded"
                  required
                  disabled={!!modal.usuario}
                />
              </div>

              <div>
                <label className="block mb-2 font-medium"><Emoji symbol="üéñÔ∏è" /> Rol:</label>
                <select
                  value={form.rol}
                  onChange={e => setForm({...form, rol: e.target.value})}
                  className="w-full p-2 border rounded"
                  required
                >
                  <option value="admin">Administrador</option>
                  <option value="registrador">Registrador</option>
                  <option value="copropietario">Copropietario</option>
                </select>
              </div>

              <div className="flex items-center gap-2">
                <input
                  type="checkbox"
                  checked={form.activo}
                  onChange={e => setForm({...form, activo: e.target.checked})}
                  className="w-4 h-4"
                />
                <label className="font-medium"><Emoji symbol="‚úîÔ∏è" /> Usuario activo</label>
              </div>

              <div className="flex justify-end gap-2 mt-4">
                <button
                  type="button"
                  className="px-4 py-2 border rounded hover:bg-gray-100"
                  onClick={() => setModal({ open: false, usuario: null })}
                >
                  <Emoji symbol="‚ùå" /> Cancelar
                </button>
                <button 
                  type="submit" 
                  className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
                  disabled={saving}
                >
                  {saving ? <Loader size="small" /> : <><Emoji symbol="üíæ" /> Guardar</>}
                </button>
              </div>
            </form>
          </div>
        </div>
      )}
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\pages\Login.jsx -----

// src/pages/Login.jsx
import React, { useState } from "react";
import supabase from "../supabaseClient";
import { useNavigate } from "react-router-dom";

export default function Login() {
  const [email, setEmail] = useState("");
  const [step, setStep] = useState("email"); // "email" o "otp"
  const [otp, setOtp] = useState("");
  const [loading, setLoading] = useState(false);
  const [info, setInfo] = useState("");
  const [error, setError] = useState("");
  const navigate = useNavigate();

  // Enviar c√≥digo OTP al correo
  const handleSendCode = async (e) => {
    e.preventDefault();
    setError("");
    setInfo("");
    setLoading(true);

    const { error } = await supabase.auth.signInWithOtp({
      email,
      options: {
        shouldCreateUser: true, // o false si solo quieres permitir acceso a usuarios existentes
        // emailRedirectTo: 'https://TU_DOMINIO.com/' // opcional, si quieres redirigir tras login
      },
    });

    setLoading(false);

    if (error) {
      setError(error.message);
    } else {
      setStep("otp");
      setInfo("Se ha enviado un c√≥digo a tu correo electr√≥nico.");
    }
  };

  // Verificar el c√≥digo OTP
  const handleVerifyCode = async (e) => {
    e.preventDefault();
    setError("");
    setInfo("");
    setLoading(true);

    const { error } = await supabase.auth.verifyOtp({
      email,
      token: otp,
      type: "email",
    });

    setLoading(false);

    if (error) {
      setError(error.message);
    } else {
      setInfo("¬°Autenticaci√≥n exitosa! Redirigiendo...");
      // Espera un momento y redirige
      setTimeout(() => navigate("/"), 1500);
    }
  };

  return (
    <div className="min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900">
      <div className="w-full max-w-md bg-white dark:bg-gray-800 rounded-lg shadow-lg p-8">
        <h2 className="text-2xl font-bold mb-6 text-center text-gray-800 dark:text-gray-100">
          Iniciar sesi√≥n sin contrase√±a
        </h2>
        {step === "email" ? (
          <form onSubmit={handleSendCode} className="space-y-4">
            <div>
              <label className="block mb-1 text-gray-700 dark:text-gray-300">
                Correo electr√≥nico
              </label>
              <input
                type="email"
                className="w-full px-4 py-2 border rounded focus:outline-none focus:ring"
                value={email}
                onChange={e => setEmail(e.target.value)}
                required
                autoComplete="email"
                disabled={loading}
              />
            </div>
            {error && (
              <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded">
                {error}
              </div>
            )}
            {info && (
              <div className="bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded">
                {info}
              </div>
            )}
            <button
              type="submit"
              className="w-full py-2 px-4 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
              disabled={loading}
            >
              {loading ? "Enviando..." : "Enviar c√≥digo"}
            </button>
          </form>
        ) : (
          <form onSubmit={handleVerifyCode} className="space-y-4">
            <div>
              <label className="block mb-1 text-gray-700 dark:text-gray-300">
                Ingresa el c√≥digo recibido por email
              </label>
              <input
                type="text"
                className="w-full px-4 py-2 border rounded focus:outline-none focus:ring"
                value={otp}
                onChange={e => setOtp(e.target.value)}
                required
                disabled={loading}
                maxLength={6}
                inputMode="numeric"
              />
            </div>
            {error && (
              <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-2 rounded">
                {error}
              </div>
            )}
            {info && (
              <div className="bg-green-100 border border-green-400 text-green-700 px-4 py-2 rounded">
                {info}
              </div>
            )}
            <button
              type="submit"
              className="w-full py-2 px-4 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors"
              disabled={loading}
            >
              {loading ? "Verificando..." : "Verificar c√≥digo"}
            </button>
          </form>
        )}
      </div>
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\pages\RegistroParqueo.jsx -----

import React, { useState, useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import supabase from '../supabaseClient';
import ResizeImage from '../components/ResizeImage';
import Loader from '../components/Loader';
import Emoji from '../components/Emoji';
import useOnlineStatus from '../hooks/useOnlineStatus';

export default function RegistroParqueo() {
  const [formData, setFormData] = useState({
    placa_vehiculo: '',
    tipo_vehiculo: 'carro',
    propiedad: '',
    unidad: '',
    observaciones: '',
    gratis: false,
    fecha_hora_ingreso: new Date().toISOString().slice(0, 16)
  });

  const [fotos, setFotos] = useState([]);
  const [copropietarios, setCopropietarios] = useState([]);
  const [propiedades, setPropiedades] = useState([]);
  const [unidadesFiltradas, setUnidadesFiltradas] = useState([]);
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');
  const isOnline = useOnlineStatus();
  const navigate = useNavigate();

  // Cargar copropietarios y propiedades
  useEffect(() => {
    const fetchCopropietarios = async () => {
      try {
        const { data, error } = await supabase
          .from('copropietarios')
          .select('id, propiedad, unidad_asignada');
        
        if (error) throw error;
        
        const uniquePropiedades = [...new Set(data.map(c => c.propiedad))].sort();
        setCopropietarios(data);
        setPropiedades(uniquePropiedades);
        
      } catch (error) {
        setError(`Error cargando propiedades: ${error.message}`);
      }
    };
    
    if (isOnline) fetchCopropietarios();
  }, [isOnline]);

  // Actualizar unidades al cambiar propiedad
  useEffect(() => {
    if (formData.propiedad) {
      const unidades = copropietarios
        .filter(c => c.propiedad === formData.propiedad)
        .map(c => c.unidad_asignada)
        .filter((v, i, a) => a.indexOf(v) === i)
        .sort();
      
      setUnidadesFiltradas(unidades);
      setFormData(prev => ({ ...prev, unidad: '' }));
    }
  }, [formData.propiedad, copropietarios]);

  const handleFotos = (files) => {
    setFotos(files.slice(0, 5)); // Limitar a m√°ximo 5 fotos
  };

  const obtenerDependenciaId = () => {
    return copropietarios.find(
      c => c.propiedad === formData.propiedad && 
           c.unidad_asignada === formData.unidad
    )?.id || null;
  };

  const submitRegistro = async (e) => {
    e.preventDefault();
    setLoading(true);
    setError('');

    try {
      // Validaciones
      if (!formData.placa_vehiculo.match(/^[A-Z0-9]{3,8}$/i)) {
        throw new Error('Formato de placa inv√°lido (3-8 caracteres alfanum√©ricos)');
      }
      
      const dependenciaId = obtenerDependenciaId();
      if (!dependenciaId) throw new Error('Debe seleccionar propiedad y unidad v√°lida');

      // Subir m√∫ltiples fotos si hay conexi√≥n
      let fotoUrls = [];
      if (isOnline && fotos.length > 0) {
        fotoUrls = await Promise.all(
          fotos.map(async (foto) => {
            const fileName = `parqueo/${Date.now()}_${foto.name}`;
            const { error: uploadError } = await supabase.storage
              .from('evidencias-parqueadero')
              .upload(fileName, foto);
            
            if (uploadError) throw uploadError;
            
            const { data: urlData } = supabase.storage
              .from('evidencias-parqueadero')
              .getPublicUrl(fileName);
            return urlData.publicUrl;
          })
        );
      }

      // Insertar registro principal
      const { data: userData } = await supabase.auth.getUser();
      
      const { error: insertError } = await supabase
        .from('registros_parqueadero')
        .insert([{
          placa_vehiculo: formData.placa_vehiculo.toUpperCase(),
          tipo_vehiculo: formData.tipo_vehiculo,
          dependencia_id: dependenciaId,
          usuario_id: userData.user?.id,
          observaciones: formData.observaciones,
          fecha_hora_ingreso: formData.fecha_hora_ingreso,
          monto: formData.gratis ? 0 : (formData.tipo_vehiculo === 'carro' ? 1.00 : 0.50),
          gratis: formData.gratis,
          foto_url: isOnline ? fotoUrls : [],
          pending_photos: !isOnline && fotos.length > 0
        }]);

      if (insertError) throw insertError;

      navigate('/consultas');
    } catch (err) {
      setError(err.message);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="container mx-auto p-4 max-w-3xl">
      <h2 className="text-2xl font-bold mb-6">
        <Emoji symbol="üìù" /> Registro de Parqueo
      </h2>

      <form onSubmit={submitRegistro} className="space-y-4">
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
          {/* Se mantienen todos los inputs existentes */}
          <div>
            <label className="block text-sm font-medium mb-1">Placa del veh√≠culo</label>
            <input
              type="text"
              value={formData.placa_vehiculo}
              onChange={(e) => setFormData({ ...formData, placa_vehiculo: e.target.value.toUpperCase() })}
              className="w-full p-2 border rounded focus:ring-2 focus:ring-blue-500"
              placeholder="ABC123"
              required
              pattern="[A-Z0-9]{3,8}"
              title="3-8 caracteres alfanum√©ricos"
            />
          </div>

          <div>
            <label className="block text-sm font-medium mb-1">Tipo de veh√≠culo</label>
            <select
              value={formData.tipo_vehiculo}
              onChange={(e) => setFormData({ ...formData, tipo_vehiculo: e.target.value })}
              className="w-full p-2 border rounded bg-white"
            >
              <option value="carro">üöó Carro</option>
              <option value="moto">üèçÔ∏è Moto</option>
            </select>
          </div>

          <div>
            <label className="block text-sm font-medium mb-1">Propiedad</label>
            <select
              value={formData.propiedad}
              onChange={(e) => setFormData({ ...formData, propiedad: e.target.value })}
              className="w-full p-2 border rounded bg-white"
              required
            >
              <option value="">Seleccionar propiedad...</option>
              {propiedades.map(propiedad => (
                <option key={propiedad} value={propiedad}>{propiedad}</option>
              ))}
            </select>
          </div>

          <div>
            <label className="block text-sm font-medium mb-1">Unidad asignada</label>
            <select
              value={formData.unidad}
              onChange={(e) => setFormData({ ...formData, unidad: e.target.value })}
              className="w-full p-2 border rounded bg-white"
              required
              disabled={!formData.propiedad}
            >
              <option value="">Seleccionar unidad...</option>
              {unidadesFiltradas.map(unidad => (
                <option key={unidad} value={unidad}>{unidad}</option>
              ))}
            </select>
          </div>

          <div>
            <label className="block text-sm font-medium mb-1">Fecha y Hora</label>
            <input
              type="datetime-local"
              value={formData.fecha_hora_ingreso}
              onChange={(e) => setFormData({ ...formData, fecha_hora_ingreso: e.target.value })}
              className="w-full p-2 border rounded"
              required
            />
          </div>
        </div>

        {/* Secci√≥n de fotos modificada para m√∫ltiples im√°genes */}
        <div className="space-y-2">
          <label className="block text-sm font-medium">Evidencia fotogr√°fica</label>
          <ResizeImage 
            onFilesSelected={handleFotos}
            maxFiles={5}
            disabled={!isOnline}
            maxWidth={800}
            quality={0.8}
          />
          <div className="flex flex-wrap gap-2 mt-2">
            {fotos.map((file, index) => (
              <img
                key={index}
                src={URL.createObjectURL(file)}
                alt={`Previsualizaci√≥n ${index + 1}`}
                className="w-16 h-16 object-cover rounded border"
              />
            ))}
          </div>
          <small className="text-gray-500 text-sm">
            M√°ximo 5 fotos (JPEG/PNG, 2MB cada una)
          </small>
        </div>

        {/* Resto del formulario se mantiene igual */}
        <div>
          <label className="block text-sm font-medium mb-1">Observaciones</label>
          <textarea
            value={formData.observaciones}
            onChange={(e) => setFormData({ ...formData, observaciones: e.target.value })}
            className="w-full p-2 border rounded"
            rows="3"
            placeholder="Detalles adicionales..."
          />
        </div>

        <div className="flex items-center gap-2">
          <input
            type="checkbox"
            id="gratis"
            checked={formData.gratis}
            onChange={(e) => setFormData({ ...formData, gratis: e.target.checked })}
            className="w-4 h-4 text-blue-600 border rounded"
          />
          <label htmlFor="gratis" className="flex items-center gap-1 text-sm">
            <Emoji symbol="üÜì" /> Registro gratuito (justificar en observaciones)
          </label>
        </div>

        {error && (
          <div className="p-3 bg-red-100 text-red-700 rounded-lg">
            <Emoji symbol="‚ö†Ô∏è" /> {error}
          </div>
        )}

        <div className="flex justify-end gap-4 mt-6">
          <button
            type="button"
            onClick={() => navigate('/')}
            className="px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600 transition-colors"
          >
            Cancelar
          </button>
          <button
            type="submit"
            className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition-colors flex items-center gap-2"
            disabled={loading || (!isOnline && fotos.length > 0)}
          >
            {loading ? <Loader text="Guardando..." /> : 'Guardar Registro'}
          </button>
        </div>

        {!isOnline && (
          <div className="p-3 bg-yellow-100 text-yellow-700 rounded-lg">
            <Emoji symbol="‚ö†Ô∏è" /> Modo offline: Las fotos se sincronizar√°n autom√°ticamente al recuperar conexi√≥n
          </div>
        )}
      </form>
    </div>
  );
}


----- C:\ThomasParking\ThomasParking\src\pages\ResumenRecaudo.jsx -----

// src/components/ResumenRecaudo.jsx
import React, { useState, useEffect } from 'react'
import supabase from '../supabaseClient'
import Loader from '../components/Loader'
import Emoji from '../components/Emoji'

export default function ResumenRecaudo({ refreshKey }) {
  const [registros, setRegistros] = useState([])
  const [loading, setLoading] = useState(true)
  const [error, setError] = useState(null)
  const [montoRecaudar, setMontoRecaudar] = useState('')
  const [procesando, setProcesando] = useState(false)
  const [filtroPropiedad, setFiltroPropiedad] = useState('')
  const [filtroUnidad, setFiltroUnidad] = useState('')
  const [filtroCopropietario, setFiltroCopropietario] = useState('')
  const [editModal, setEditModal] = useState({ open: false, registro: null })
  const [editData, setEditData] = useState({})
  const [propiedades, setPropiedades] = useState([])
  const [unidades, setUnidades] = useState([])

  useEffect(() => {
    const fetchCopropietarios = async () => {
      const { data, error } = await supabase
        .from('copropietarios')
        .select('propiedad, unidad_asignada')
      if (!error) {
        const props = [...new Set(data.map(d => d.propiedad))].sort()
        setPropiedades(props)
        setUnidades(data)
      }
    }
    fetchCopropietarios()
  }, [])

  const unidadesFiltradas = filtroPropiedad
    ? [...new Set(unidades.filter(u => u.propiedad === filtroPropiedad).map(u => u.unidad_asignada))]
    : []

  const fetchData = async () => {
    setLoading(true)
    try {
      const { data, error } = await supabase
        .from('registros_parqueadero')
        .select(`
          *,
          copropietarios:dependencia_id(nombre, propiedad, unidad_asignada)
        `)
        .order('fecha_hora_ingreso', { ascending: false })

      if (error) throw error
      setRegistros(data)
    } catch (error) {
      setError(error.message)
    } finally {
      setLoading(false)
    }
  }

  useEffect(() => { fetchData() }, [refreshKey])

  const handleRecaudoAutomatico = async () => {
    if (!filtroPropiedad || !filtroUnidad) {
      alert('Debe seleccionar propiedad y unidad asignada')
      return
    }

    const montoObjetivo = parseFloat(montoRecaudar)
    if (isNaN(montoObjetivo) || montoObjetivo <= 0) {
      alert('Ingrese un monto v√°lido')
      return
    }

    setProcesando(true)
    try {
      const { data: registrosParaRecaudar, error } = await supabase
        .from('registros_parqueadero')
        .select(`
          *,
          copropietarios:dependencia_id(propiedad, unidad_asignada)
        `)
        .eq('copropietarios.propiedad', filtroPropiedad)
        .eq('copropietarios.unidad_asignada', filtroUnidad)
        .eq('recaudado', false)
        .eq('gratis', false)
        .order('fecha_hora_ingreso', { ascending: true })

      if (error) throw error
      if (!registrosParaRecaudar?.length) {
        alert('No hay registros pendientes para esta propiedad/unidad')
        return
      }

      let montoAcumulado = 0
      const registrosAMarcar = registrosParaRecaudar
        .filter(reg => {
          if (montoAcumulado >= montoObjetivo) return false
          montoAcumulado += Number(reg.monto)
          return true
        })
        .map(reg => reg.id)

      const { error: updateError } = await supabase
        .from('registros_parqueadero')
        .update({
          recaudado: true,
          fecha_recaudo: new Date().toISOString().slice(0, 10)
        })
        .in('id', registrosAMarcar)

      if (updateError) throw updateError

      alert(`Recaudado $${montoAcumulado.toFixed(2)} en ${registrosAMarcar.length} registros`)
      fetchData()
      setMontoRecaudar('')
    } catch (error) {
      alert('Error: ' + error.message)
    } finally {
      setProcesando(false)
    }
  }

  const registrosFiltrados = registros.filter(reg => {
    const coincidePropiedad = !filtroPropiedad || (reg.copropietarios?.propiedad || '') === filtroPropiedad
    const coincideUnidad = !filtroUnidad || (reg.copropietarios?.unidad_asignada || '') === filtroUnidad
    const coincideCopropietario = !filtroCopropietario || (reg.copropietarios?.nombre || '').toLowerCase().includes(filtroCopropietario.toLowerCase())
    return coincidePropiedad && coincideUnidad && coincideCopropietario
  })

  const resumen = registrosFiltrados.reduce((acc, reg) => {
    if (reg.gratis) acc.gratis++
    else if (reg.recaudado) acc.recaudado += Number(reg.monto)
    else acc.pendiente += Number(reg.monto)
    return acc
  }, { recaudado: 0, pendiente: 0, gratis: 0 })

  const handleEditSave = async () => {
    const id = editModal.registro.id
    const monto = editData.gratis ? 0 : (editData.tipo_vehiculo === 'carro' ? 1.00 : 0.50)

    try {
      const { error } = await supabase
        .from('registros_parqueadero')
        .update({ ...editData, monto })
        .eq('id', id)

      if (error) throw error
      fetchData()
      setEditModal({ open: false, registro: null })
    } catch (error) {
      alert(error.message)
    }
  }

  const handleDelete = async (id) => {
    if (!window.confirm('¬øSeguro que desea eliminar este registro?')) return
    try {
      const { error } = await supabase
        .from('registros_parqueadero')
        .delete()
        .eq('id', id)
      if (error) throw error
      fetchData()
    } catch (error) {
      alert(error.message)
    }
  }

  return (
    <div className="resumen-container">
      <h2><Emoji symbol="üìä" label="Resumen" /> Resumen de Recaudaci√≥n</h2>

      <div className="resumen-visual">
        <div className="resumen-item recaudado">
          <Emoji symbol="üí∞" /> ${resumen.recaudado.toFixed(2)}
          <span>Recaudado</span>
        </div>
        <div className="resumen-item pendiente">
          <Emoji symbol="‚è≥" /> ${resumen.pendiente.toFixed(2)}
          <span>Pendiente</span>
        </div>
        <div className="resumen-item gratis">
          <Emoji symbol="üÜì" /> {resumen.gratis}
          <span>Gratis</span>
        </div>
      </div>

      <section className="recaudo-automatico">
        <h3><Emoji symbol="‚ö°" /> Recaudo Autom√°tico</h3>
        <div className="filtros-recaudo">
          <div className="filtro-group">
            <label><Emoji symbol="üè†" /> Propiedad:</label>
            <select
              value={filtroPropiedad}
              onChange={e => {
                setFiltroPropiedad(e.target.value)
                setFiltroUnidad('')
              }}
            >
              <option value="">Seleccione propiedad</option>
              {propiedades.map(prop => (
                <option key={prop} value={prop}>{prop}</option>
              ))}
            </select>
          </div>

          <div className="filtro-group">
            <label><Emoji symbol="üî¢" /> Unidad:</label>
            <select
              value={filtroUnidad}
              onChange={e => setFiltroUnidad(e.target.value)}
              disabled={!filtroPropiedad}
            >
              <option value="">Seleccione unidad</option>
              {unidadesFiltradas.map(unidad => (
                <option key={unidad} value={unidad}>{unidad}</option>
              ))}
            </select>
          </div>

          <div className="filtro-group">
            <label><Emoji symbol="üíµ" /> Monto objetivo:</label>
            <input
              type="number"
              step="0.01"
              value={montoRecaudar}
              onChange={e => setMontoRecaudar(e.target.value)}
              placeholder="Ej: 50.00"
            />
          </div>

          <button
            className="btn-recaudo"
            onClick={handleRecaudoAutomatico}
            disabled={procesando || !filtroPropiedad || !filtroUnidad}
          >
            {procesando ? 'Procesando...' : 'Ejecutar Recaudo'}
          </button>
        </div>
      </section>

      <div className="filtros-avanzados">
        <div className="filtro-group">
          <label><Emoji symbol="üë•" /> Copropietario:</label>
          <input
            type="text"
            value={filtroCopropietario}
            onChange={e => setFiltroCopropietario(e.target.value)}
            placeholder="Filtrar por nombre"
          />
        </div>
      </div>

      <div className="detalle-recaudo">
        <h3><Emoji symbol="üìã" /> Detalle de Registros</h3>
        <div className="tabla-detalle">
          <table>
            <thead>
              <tr>
                <th><Emoji symbol="üöó" /> Placa</th>
                <th><Emoji symbol="üõµ" /> Tipo</th>
                <th><Emoji symbol="üíµ" /> Monto</th>
                <th><Emoji symbol="üë•" /> Copropietario</th>
                <th><Emoji symbol="üìÖ" /> Fecha Recaudo</th>
                <th><Emoji symbol="‚öôÔ∏è" /> Acciones</th>
              </tr>
            </thead>
            <tbody>
              {registrosFiltrados.map(reg => (
                <tr key={reg.id} className={reg.recaudado ? 'recaudado' : 'pendiente'}>
                  <td>{reg.placa_vehiculo}</td>
                  <td>{reg.tipo_vehiculo}</td>
                  <td>${reg.monto.toFixed(2)}</td>
                  <td>{reg.copropietarios?.nombre || '-'}</td>
                  <td>{reg.fecha_recaudo || '-'}</td>
                  <td>
                    <button onClick={() => {
                      setEditModal({ open: true, registro: reg })
                      setEditData({
                        placa_vehiculo: reg.placa_vehiculo,
                        tipo_vehiculo: reg.tipo_vehiculo,
                        fecha_hora_ingreso: reg.fecha_hora_ingreso?.slice(0, 10) || '',
                        gratis: reg.gratis
                      })
                    }}>
                      <Emoji symbol="‚úèÔ∏è" />
                    </button>
                    <button onClick={() => handleDelete(reg.id)}>
                      <Emoji symbol="üóëÔ∏è" />
                    </button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>

      {editModal.open && (
        <div className="modal-edicion">
          <h3>Editar Registro</h3>
          <form onSubmit={e => { e.preventDefault(); handleEditSave() }}>
            <label>
              Placa:
              <input
                value={editData.placa_vehiculo}
                onChange={e => setEditData({ ...editData, placa_vehiculo: e.target.value })}
                required
              />
            </label>

            <label>
              Tipo:
              <select
                value={editData.tipo_vehiculo}
                onChange={e => setEditData({ ...editData, tipo_vehiculo: e.target.value })}
              >
                <option value="carro">Carro</option>
                <option value="moto">Moto</option>
              </select>
            </label>

            <label>
              Fecha ingreso:
              <input
                type="date"
                value={editData.fecha_hora_ingreso}
                onChange={e => setEditData({ ...editData, fecha_hora_ingreso: e.target.value })}
              />
            </label>

            <label className="checkbox">
              <input
                type="checkbox"
                checked={editData.gratis}
                onChange={e => setEditData({ ...editData, gratis: e.target.checked })}
              />
              <Emoji symbol="üÜì" /> Gratis
            </label>

            <div className="acciones-modal">
              <button type="submit">Guardar</button>
              <button type="button" onClick={() => setEditModal({ open: false, registro: null })}>
                Cancelar
              </button>
            </div>
          </form>
        </div>
      )}

      {loading && <Loader text="Cargando datos..." />}
      {error && <div className="error-message">{error}</div>}
    </div>
  )
}


----- C:\ThomasParking\ThomasParking\src\providers\QueryClientProvider.jsx -----

// src/providers/QueryClientProvider.jsx
import React from 'react'
import { QueryClient, QueryClientProvider } from '@tanstack/react-query'
import { ReactQueryDevtools } from '@tanstack/react-query-devtools'

// Configura el QueryClient con opciones recomendadas para producci√≥n
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000,     // 5 minutos: los datos se consideran frescos
      cacheTime: 30 * 60 * 1000,    // 30 minutos: tiempo de vida en cach√©
      retry: 2,                     // Reintenta 2 veces en caso de error
      refetchOnWindowFocus: false,  // No recargar al cambiar de pesta√±a
      useErrorBoundary: true        // Usa ErrorBoundary para errores
    },
    mutations: {
      useErrorBoundary: true
    }
  }
})

/**
 * Envuelve tu aplicaci√≥n con este provider para habilitar React Query globalmente.
 * Uso:
 * <MyQueryClientProvider>
 *   <App />
 * </MyQueryClientProvider>
 */
export default function MyQueryClientProvider({ children }) {
  return (
    <QueryClientProvider client={queryClient}>
      {children}
      {import.meta.env.DEV && <ReactQueryDevtools initialIsOpen={false} />}
    </QueryClientProvider>
  )
}


----- C:\ThomasParking\ThomasParking\src\styles\global.css -----

/* global.css */
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

:root {
  /* Sistema de dise√±o */
  --max-width: 1280px;
  --border-radius: 12px;
  --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
  
  /* Paleta de colores - Modo claro */
  --background: 255 255 255;
  --foreground: 23 23 23;
  --primary: 99 102 241;
  --primary-foreground: 255 255 255;
  --secondary: 56 189 248;
  --muted: 244 244 245;
  --muted-foreground: 82 82 91;
  --success: 34 197 94;
  --warning: 245 158 66;
  --danger: 239 68 68;
  --accent: 255 111 145;
  
  /* Sombras */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
}

/* Modo oscuro */
[data-theme="dark"] {
  --background: 24 24 27;
  --foreground: 244 244 245;
  --primary: 129 140 248;
  --muted: 39 39 42;
  --muted-foreground: 161 161 170;
  --accent: 244 114 182;
}

/* Base */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

html {
  scroll-behavior: smooth;
  scroll-padding-top: 80px;
}

body {
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
  line-height: 1.6;
  color: rgb(var(--foreground));
  background-color: rgb(var(--background));
  -webkit-font-smoothing: antialiased;
  transition: var(--transition);
}

/* Tipograf√≠a */
h1, h2, h3, h4 {
  line-height: 1.2;
  font-weight: 700;
  margin-bottom: 1.25rem;
}

h1 { font-size: 2.5rem; }
h2 { font-size: 2rem; }
h3 { font-size: 1.75rem; }

/* Componentes principales */
.container {
  width: 100%;
  max-width: var(--max-width);
  margin: 0 auto;
  padding: 0 1.5rem;
}

/* Navbar */
.navbar {
  position: fixed;
  top: 0;
  width: 100%;
  background: linear-gradient(135deg, rgb(var(--primary)) 0%, rgb(var(--secondary)) 100%);
  box-shadow: var(--shadow-lg);
  z-index: 50;
}

.navbar-content {
  height: 4rem;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

/* Footer */
.footer {
  background: rgb(var(--muted));
  border-top: 1px solid rgb(var(--muted) / 0.2);
  padding: 2rem 0;
  margin-top: auto;
}

.footer-links {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 2rem;
}

/* Formularios */
.input-group {
  display: grid;
  gap: 0.75rem;
}

input, select, textarea {
  width: 100%;
  padding: 0.75rem 1rem;
  border: 1px solid rgb(var(--muted));
  border-radius: calc(var(--border-radius) / 2);
  background: rgb(var(--background));
  transition: var(--transition);
}

input:focus, select:focus, textarea:focus {
  outline: 2px solid rgb(var(--primary) / 0.5);
  border-color: rgb(var(--primary));
}

/* Botones */
.btn {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.75rem 1.5rem;
  border-radius: var(--border-radius);
  font-weight: 500;
  transition: var(--transition);
  cursor: pointer;
}

.btn-primary {
  background: rgb(var(--primary));
  color: rgb(var(--primary-foreground));
}

.btn-primary:hover {
  background: rgb(var(--primary) / 0.9);
  transform: translateY(-1px);
}

/* Tablas */
.table-container {
  overflow-x: auto;
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-md);
}

.table {
  width: 100%;
  border-collapse: collapse;
  background: rgb(var(--background));
}

.table th {
  background: rgb(var(--muted));
  padding: 1rem;
  text-align: left;
  font-weight: 600;
}

.table td {
  padding: 1rem;
  border-top: 1px solid rgb(var(--muted));
}

.table tr:hover {
  background: rgb(var(--muted) / 0.1);
}

/* Modales */
.modal-overlay {
  position: fixed;
  inset: 0;
  background: rgb(0 0 0 / 0.5);
  backdrop-filter: blur(4px);
  display: grid;
  place-items: center;
  z-index: 100;
}

.modal-content {
  background: rgb(var(--background));
  border-radius: var(--border-radius);
  padding: 2rem;
  width: min(90vw, 600px);
  max-height: 90vh;
  overflow-y: auto;
  box-shadow: var(--shadow-lg);
}

/* Utilidades */
.loading-spinner {
  width: 2rem;
  height: 2rem;
  border: 3px solid rgb(var(--muted));
  border-top-color: rgb(var(--primary));
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.thumbnail {
  width: 48px;
  height: 48px;
  object-fit: cover;
  border-radius: calc(var(--border-radius) / 2);
  border: 1px solid rgb(var(--muted));
}

.error-message {
  padding: 1rem;
  background: rgb(var(--danger) / 0.1);
  border: 1px solid rgb(var(--danger));
  color: rgb(var(--danger));
  border-radius: calc(var(--border-radius) / 2);
}

/* Responsive */
@media (max-width: 768px) {
  .navbar-menu { display: none; }
  .table th, .table td { padding: 0.75rem; }
  
  .mobile-menu-active {
    transform: translateX(0) !important;
  }
}
