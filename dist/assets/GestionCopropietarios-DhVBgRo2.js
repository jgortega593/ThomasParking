import{r as t,j as e,E as s,L as N,s as c}from"./index-B8c5qOFd.js";function C(){const[u,x]=t.useState([]),[j,m]=t.useState(!0),[b,i]=t.useState(null),[n,d]=t.useState({open:!1,copropietario:null}),[r,l]=t.useState({nombre:"",propiedad:"",unidad_asignada:""}),p=async()=>{m(!0);const{data:a,error:o}=await c.from("copropietarios").select("*").order("propiedad");o?i(o.message):x(a),m(!1)};t.useEffect(()=>{p()},[]);const h=async a=>{if(a.preventDefault(),i(null),!r.nombre||!r.propiedad||!r.unidad_asignada){i("Todos los campos son obligatorios");return}if(n.copropietario){const{error:o}=await c.from("copropietarios").update(r).eq("id",n.copropietario.id);o&&i(o.message)}else{const{error:o}=await c.from("copropietarios").insert([r]);o&&i(o.message)}d({open:!1,copropietario:null}),l({nombre:"",propiedad:"",unidad_asignada:""}),p()},g=async a=>{if(!window.confirm("¬øEliminar copropietario?"))return;const{error:o}=await c.from("copropietarios").delete().eq("id",a);o&&i(o.message),p()},f=a=>{l({nombre:a.nombre,propiedad:a.propiedad,unidad_asignada:a.unidad_asignada}),d({open:!0,copropietario:a})},y=()=>{l({nombre:"",propiedad:"",unidad_asignada:""}),d({open:!0,copropietario:null})};return e.jsxs("div",{className:"gestion-copropietarios-container",children:[e.jsxs("h2",{children:[e.jsx(s,{symbol:"üë•",label:"Copropietarios"})," Gesti√≥n de Copropietarios"]}),e.jsxs("button",{className:"edit-btn",onClick:y,children:[e.jsx(s,{symbol:"‚ûï",label:"Agregar"})," Nuevo copropietario"]}),j?e.jsx(N,{}):e.jsxs("table",{className:"resultados-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsxs("th",{children:[e.jsx(s,{symbol:"üßë",label:"Nombre"})," Nombre"]}),e.jsxs("th",{children:[e.jsx(s,{symbol:"üè¢",label:"Propiedad"})," Propiedad"]}),e.jsxs("th",{children:[e.jsx(s,{symbol:"üî¢",label:"Unidad"})," Unidad"]}),e.jsxs("th",{children:[e.jsx(s,{symbol:"‚öôÔ∏è",label:"Acciones"})," Acciones"]})]})}),e.jsx("tbody",{children:u.map(a=>e.jsxs("tr",{children:[e.jsx("td",{children:a.nombre}),e.jsx("td",{children:a.propiedad}),e.jsx("td",{children:a.unidad_asignada}),e.jsxs("td",{children:[e.jsx("button",{className:"edit-btn",onClick:()=>f(a),title:"Editar",children:e.jsx(s,{symbol:"‚úèÔ∏è",label:"Editar"})}),e.jsx("button",{className:"delete-btn",onClick:()=>g(a.id),title:"Eliminar",children:e.jsx(s,{symbol:"üóëÔ∏è",label:"Eliminar"})})]})]},a.id))})]}),b&&e.jsx("div",{className:"error-message",children:b}),n.open&&e.jsx("div",{className:"modal-backdrop",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("h3",{children:[e.jsx(s,{symbol:n.copropietario?"‚úèÔ∏è":"‚ûï",label:n.copropietario?"Editar":"Nuevo"})," ",n.copropietario?"Editar":"Nuevo"," Copropietario"]}),e.jsxs("form",{className:"modal-form",onSubmit:h,children:[e.jsxs("label",{children:[e.jsx(s,{symbol:"üßë",label:"Nombre"})," Nombre:",e.jsx("input",{value:r.nombre,onChange:a=>l({...r,nombre:a.target.value}),required:!0})]}),e.jsxs("label",{children:[e.jsx(s,{symbol:"üè¢",label:"Propiedad"})," Propiedad:",e.jsx("input",{value:r.propiedad,onChange:a=>l({...r,propiedad:a.target.value}),required:!0})]}),e.jsxs("label",{children:[e.jsx(s,{symbol:"üî¢",label:"Unidad"})," Unidad asignada:",e.jsx("input",{value:r.unidad_asignada,onChange:a=>l({...r,unidad_asignada:a.target.value}),required:!0})]}),e.jsxs("div",{children:[e.jsxs("button",{type:"submit",className:"save-btn",children:[e.jsx(s,{symbol:"üíæ",label:"Guardar"})," Guardar"]}),e.jsxs("button",{type:"button",className:"cancel-btn",onClick:()=>d({open:!1,copropietario:null}),children:[e.jsx(s,{symbol:"‚ùå",label:"Cancelar"})," Cancelar"]})]})]})]})})]})}export{C as default};
//# sourceMappingURL=GestionCopropietarios-DhVBgRo2.js.map
